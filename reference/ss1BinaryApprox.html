<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sample Size Calculation for a Single Binary Endpoint — ss1BinaryApprox • twoCoprimary</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size Calculation for a Single Binary Endpoint — ss1BinaryApprox"><meta name="description" content="Calculates the required sample size for a two-arm superiority trial with a
single binary endpoint using various statistical testing methods."><meta property="og:description" content="Calculates the required sample size for a two-arm superiority trial with a
single binary endpoint using various statistical testing methods."></head><body><p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample Size Calculation for a Single Binary Endpoint</h1>
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/R/ss1BinaryApprox.R" class="external-link"><code>R/ss1BinaryApprox.R</code></a></small>
      <div class="d-none name"><code>ss1BinaryApprox.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the required sample size for a two-arm superiority trial with a
single binary endpoint using various statistical testing methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">r</span>, <span class="va">alpha</span>, <span class="va">beta</span>, Test <span class="op">=</span> <span class="st">"AN"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>True probability of responders in group 1 (0 &lt; p1 &lt; 1)</p></dd>


<dt id="arg-p-">p2<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>True probability of responders in group 2 (0 &lt; p2 &lt; 1)</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Allocation ratio of group 1 to group 2 (group 1:group 2 = r:1, where r &gt; 0)</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>One-sided significance level (typically 0.025)</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Target type II error rate (typically 0.1 or 0.2)</p></dd>


<dt id="arg-test">Test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>Statistical testing method. One of:</p><ul><li><p><code>"AN"</code>: Asymptotic normal method without continuity correction (default)</p></li>
<li><p><code>"ANc"</code>: Asymptotic normal method with continuity correction</p></li>
<li><p><code>"AS"</code>: Arcsine transformation without continuity correction</p></li>
<li><p><code>"ASc"</code>: Arcsine transformation with continuity correction</p></li>
<li><p><code>"Fisher"</code>: Fisher's exact test with iterative sample size determination</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p>
<dl><dt>p1</dt>
<dd><p>Probability of responders in group 1</p></dd>

<dt>p2</dt>
<dd><p>Probability of responders in group 2</p></dd>

<dt>r</dt>
<dd><p>Allocation ratio</p></dd>

<dt>alpha</dt>
<dd><p>One-sided significance level</p></dd>

<dt>beta</dt>
<dd><p>Type II error rate</p></dd>

<dt>Test</dt>
<dd><p>Testing method used</p></dd>

<dt>n1</dt>
<dd><p>Required sample size for group 1</p></dd>

<dt>n2</dt>
<dd><p>Required sample size for group 2</p></dd>

<dt>N</dt>
<dd><p>Total sample size (n1 + n2)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements sample size calculations for single binary endpoint
trials using five different methods.</p>
<p><strong>Important:</strong> This function is designed for a <strong>single binary endpoint</strong>.
For co-primary endpoints, use <code><a href="ss2BinaryApprox.html">ss2BinaryApprox</a></code> (for approximate
methods) or <code><a href="ss2BinaryExact.html">ss2BinaryExact</a></code> (for exact methods).</p>
<p><strong>Notation:</strong></p><ul><li><p>r = n1/n2: allocation ratio (group 1 to group 2)</p></li>
<li><p>kappa = 1/r = n2/n1: inverse allocation ratio</p></li>
<li><p>p1, p2: response probabilities</p></li>
<li><p>theta1 = 1 - p1, theta2 = 1 - p2: non-response probabilities</p></li>
<li><p>delta = p1 - p2: treatment effect</p></li>
</ul><p><strong>AN (Asymptotic Normal) Method:</strong>
Uses the standard normal approximation with pooled variance under H0:
$$n_2 = \left\lceil \frac{(1 + \kappa)}{(\pi_1 - \pi_2)^2}
      \left(z_{1-\alpha} \sqrt{\bar{\pi}(1-\bar{\pi})} +
      z_{1-\beta} \sqrt{\kappa\pi_1\theta_1 + \pi_2\theta_2}\right)^2 / \kappa \right\rceil$$
where \(\bar{\pi} = (r\pi_1 + \pi_2)/(1 + r)\) is the pooled proportion.</p>
<p><strong>ANc Method:</strong>
Adds continuity correction to the AN method. Uses iterative calculation because
the correction term depends on sample size. Converges when the difference between
successive iterations is less than or equal to 1.</p>
<p><strong>AS (Arcsine) Method:</strong>
Uses the variance-stabilizing arcsine transformation:
$$n_2 = \left\lceil \frac{(z_{1-\alpha} + z_{1-\beta})^2}{4(\sin^{-1}\sqrt{\pi_1} - \sin^{-1}\sqrt{\pi_2})^2} \times \frac{1 + \kappa}{\kappa} \right\rceil$$</p>
<p><strong>ASc Method:</strong>
Applies continuity correction to the arcsine method. Uses iterative procedure
with convergence criterion.</p>
<p><strong>Fisher Method:</strong>
Fisher's exact test does not have a closed-form sample size formula. This method:</p><ol><li><p>Starts with the AN method's sample size as initial value</p></li>
<li><p>Incrementally increases n2 by 1</p></li>
<li><p>Calculates exact power using hypergeometric distribution</p></li>
<li><p>Stops when power is greater than or equal to 1 - beta</p></li>
</ol><p>Note: Due to the saw-tooth nature of exact power (power does not increase
monotonically with sample size), a sequential search approach is used.
The incremental approach ensures the minimum sample size that achieves the
target power.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2010). Sample size determination in
clinical trials with multiple co-primary binary endpoints. <em>Statistics in
Medicine</em>, 29(21), 2169-2179.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Balanced design with 1:1 allocation (AN method)</span></span></span>
<span class="r-in"><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.6</span>, p2 <span class="op">=</span> <span class="fl">0.4</span>, r <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, Test <span class="op">=</span> <span class="st">"AN"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size calculation for single binary endpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n1 = 130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n2 = 130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p = 0.6, 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      allocation = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Test = AN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Unbalanced design with 2:1 allocation (ANc method)</span></span></span>
<span class="r-in"><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.5</span>, p2 <span class="op">=</span> <span class="fl">0.3</span>, r <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.2</span>, Test <span class="op">=</span> <span class="st">"ANc"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size calculation for single binary endpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n1 = 156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n2 = 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p = 0.5, 0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      allocation = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Test = ANc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arcsine transformation method</span></span></span>
<span class="r-in"><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.55</span>, p2 <span class="op">=</span> <span class="fl">0.35</span>, r <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, Test <span class="op">=</span> <span class="st">"AS"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size calculation for single binary endpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n1 = 129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n2 = 129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p = 0.55, 0.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      allocation = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Test = AS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arcsine with continuity correction</span></span></span>
<span class="r-in"><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.65</span>, p2 <span class="op">=</span> <span class="fl">0.45</span>, r <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, Test <span class="op">=</span> <span class="st">"ASc"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size calculation for single binary endpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n1 = 121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n2 = 121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p = 0.65, 0.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      allocation = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Test = ASc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fisher's exact test</span></span></span>
<span class="r-in"><span><span class="fu">ss1BinaryApprox</span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.6</span>, p2 <span class="op">=</span> <span class="fl">0.4</span>, r <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, Test <span class="op">=</span> <span class="st">"Fisher"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size calculation for single binary endpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n1 = 206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              n2 = 103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p = 0.6, 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      allocation = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Test = Fisher</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer></div>





  
</body></html>

