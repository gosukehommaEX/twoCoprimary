<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mixed Continuous and Binary Co-Primary Endpoints ‚Ä¢ twoCoprimary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mixed Continuous and Binary Co-Primary Endpoints">
</head>
<body>
<p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mixed Continuous and Binary Co-Primary Endpoints</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/vignettes/mixed-continuous-binary.Rmd" class="external-link"><code>vignettes/mixed-continuous-binary.Rmd</code></a></small>
      <div class="d-none name"><code>mixed-continuous-binary.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates sample size calculation for clinical
trials with two co-primary endpoints where one is continuous and one is
binary. The methodology is based on Sozu et al.¬†(2012).</p>
<p><strong>Important note on notation</strong>: In Sozu et al.¬†(2012),
the allocation ratio is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\kappa = n_{2}/n_{1}</annotation></semantics></math>
(control/treatment), which is the inverse of the notation used in other
papers in this package where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r = n_{1}/n_{2}</annotation></semantics></math>
(treatment/control). Therefore,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><mn>1</mn><mi>/</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">\kappa = 1/r</annotation></semantics></math>.
In this vignette, we follow the notation from the original paper using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∫</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
to maintain consistency with the published formulas.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaex.github.io/twoCoprimary/" class="external-link">twoCoprimary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="clinical-context">Clinical Context<a class="anchor" aria-label="anchor" href="#clinical-context"></a>
</h3>
<p>Mixed continuous and binary co-primary endpoints are common in:</p>
<ul>
<li>
<strong>Rheumatoid arthritis trials</strong>: The mean change from
baseline in the modified total Sharp score (mTSS) + An ACR50 response
(yes/no)</li>
<li>
<strong>Chronic kidney disease trials</strong>: The mean peak
percentage change from baseline serum creatinine over the 72-h period
after contrast media administration + The contrast-induced nephropathy
(yes/no)</li>
</ul>
</div>
<div class="section level3">
<h3 id="why-mixed-endpoints">Why Mixed Endpoints?<a class="anchor" aria-label="anchor" href="#why-mixed-endpoints"></a>
</h3>
<p>Combining continuous and binary endpoints provides:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Comprehensive assessment</strong>: Magnitude of change
(continuous) + clinical meaningfulness (binary)</li>
<li>
<strong>Regulatory relevance</strong>: Many guidelines require both
types</li>
<li>
<strong>Clinical interpretability</strong>: Binary endpoints are
easier to communicate to patients</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h2>
<div class="section level3">
<h3 id="model-and-assumptions">Model and Assumptions<a class="anchor" aria-label="anchor" href="#model-and-assumptions"></a>
</h3>
<p>Consider a two-arm superiority trial with sample sizes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_{1}</annotation></semantics></math>
(treatment) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
(control), with allocation ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\kappa = n_{2}/n_{1}</annotation></semantics></math>.</p>
<p>For subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j = 1</annotation></semantics></math>:
treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">j = 2</annotation></semantics></math>:
control), we observe two <strong>outcomes</strong>:</p>
<p><strong>Outcome 1 (Continuous)</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>‚àº</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>j</mi></msub><mo>,</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{i,j,1} \sim \text{N}(\mu_{j}, \sigma^2)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_{j}</annotation></semantics></math>
is the population mean in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÉ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^{2}</annotation></semantics></math>
is the common variance across groups.</p>
<p><strong>Outcome 2 (Binary)</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k = 2</annotation></semantics></math>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">X_{i,j,2} \in \{0, 1\}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_{i,j,2} = 1</annotation></semantics></math>
if subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
responds successfully, and 0 otherwise. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>j</mi></msub><annotation encoding="application/x-tex">p_{j}</annotation></semantics></math>
denotes the true success probability in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
for endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="correlation-structure-biserial-correlation">Correlation Structure: Biserial Correlation<a class="anchor" aria-label="anchor" href="#correlation-structure-biserial-correlation"></a>
</h3>
<p>The correlation between a continuous outcome and a binary outcome
requires special consideration. Following Sozu et al.¬†(2012), we assume
that both outcomes have latent bivariate normal distributions.</p>
<p><strong>Key concept</strong>: The binary outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,2}</annotation></semantics></math>
is assumed to arise from dichotomizing a latent continuous variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><annotation encoding="application/x-tex">X_{i,j,2}^{*}</annotation></semantics></math>
(i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><mo>‚àº</mo><mtext mathvariant="normal">N</mtext><mo stretchy="false" form="prefix">(</mo><msubsup><mi>Œº</mi><mi>j</mi><mo>*</mo></msubsup><mo>,</mo><msup><mi>œÉ</mi><mrow><mn>2</mn><mo>*</mo></mrow></msup></mrow><annotation encoding="application/x-tex">X_{i,j,2}^{*}\sim\text{N}(\mu_{j}^{\ast},\sigma^{2\ast}</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><mo>‚â•</mo><msub><mi>g</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><mo>&lt;</mo><msub><mi>g</mi><mi>j</mi></msub></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">X_{i,j,2} = \begin{cases} 
1 &amp; \text{if } X_{i,j,2}^* \geq g_{j} \\
0 &amp; \text{if } X_{i,j,2}^* &lt; g_{j}
\end{cases}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>j</mi></msub><annotation encoding="application/x-tex">g_{j}</annotation></semantics></math>
is a threshold (cut-off point) such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>p</mi><mi>j</mi></msub><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><mo>‚â•</mo><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{P}(X_{i,j,2} = 1) = p_{j} = \text{P}(X_{i,j,2}^{*} \geq g_{j})</annotation></semantics></math>.</p>
<p><strong>Biserial correlation</strong>: Assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_{i,j,1}, X_{i,j,2}^{*})</annotation></semantics></math>
follow a bivariate normal distribution, the <strong>biserial
correlation</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
measures the correlation between the continuous outcome and the latent
continuous variable underlying the binary outcome.</p>
<p>For the detailed formula relating the biserial correlation to the
correlation between test statistics, see Sozu et al.¬†(2012), equation
(1) in the Supporting Information.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>We test superiority of treatment over control for both endpoints:</p>
<p><strong>For continuous endpoint</strong> (1):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>:</mo><msub><mi>Œº</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>Œº</mi><mn>2</mn></msub><mo>‚â§</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>:</mo><msub><mi>Œº</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>Œº</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{H}_{01}: \mu_{1} - \mu_{2} \leq 0 \text{ vs. } \text{H}_{11}: \mu_{1} - \mu_{2} &gt; 0</annotation></semantics></math></p>
<p><strong>For binary endpoint</strong> (2):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo>‚â§</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{H}_{02}: p_{1} - p_{2} \leq 0 \text{ vs. } \text{H}_{12}: p_{1} - p_{2} &gt; 0</annotation></semantics></math></p>
<p><strong>Co-primary endpoints</strong> (intersection-union test):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>‚à™</mo><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>‚à©</mo><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_0 = \text{H}_{01} \cup \text{H}_{02} \text{ vs. } \text{H}_1 = \text{H}_{11} \cap \text{H}_{12}</annotation></semantics></math></p>
<p>Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
if and only if <strong>both</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><annotation encoding="application/x-tex">\text{H}_{01}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><annotation encoding="application/x-tex">\text{H}_{02}</annotation></semantics></math>
are rejected at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h3>
<p><strong>Continuous endpoint</strong> (Equation 2 in Sozu et al.,
2012):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><mn>1</mn></msub><mo>‚àí</mo><msub><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><mn>2</mn></msub></mrow><mrow><mi>œÉ</mi><msqrt><mfrac><mrow><mn>1</mn><mo>+</mo><mi>Œ∫</mi></mrow><msub><mi>n</mi><mn>1</mn></msub></mfrac></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_{1} = \frac{\bar{X}_{1} - \bar{X}_{2}}{\sigma\sqrt{\frac{1+\kappa}{n_{1}}}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\bar{X}_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>X</mi><mo accent="true">‚Äæ</mo></mover><mn>2</mn></msub><annotation encoding="application/x-tex">\bar{X}_{2}</annotation></semantics></math>
are the sample means. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is unknown, use the pooled sample standard deviation.</p>
<p><strong>Binary endpoint - Asymptotic Normal (AN) method</strong>
(Equation 3 in Sozu et al., 2012):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><mo>‚àí</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>2</mn></msub></mrow><msqrt><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z_{2} = \frac{\hat{p}_{1} - \hat{p}_{2}}{\sqrt{\left(\frac{1}{n_{1}} + \frac{1}{n_{2}}\right) \hat{p}(1 - \hat{p})}}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\hat{p}_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>2</mn></msub><annotation encoding="application/x-tex">\hat{p}_{2}</annotation></semantics></math>
are the sample proportions</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mn>1</mn></msub><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>2</mn></msub></mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{p} = \frac{n_{1}\hat{p}_{1} + n_{2}\hat{p}_{2}}{n_{1} + n_{2}}</annotation></semantics></math>
is the pooled proportion</li>
</ul>
<p><strong>Other test methods</strong>: Sozu et al.¬†(2012) also
present:</p>
<ul>
<li>
<strong>ANc</strong>: Asymptotic normal with continuity correction
(equation 5)</li>
<li>
<strong>AS</strong>: Arcsine transformation without continuity
correction (equation 6)</li>
<li>
<strong>ASc</strong>: Arcsine transformation with continuity
correction (equation 7)</li>
<li>
<strong>Fisher</strong>: Fisher‚Äôs exact test (simulation-based)</li>
</ul>
<p>See the paper for detailed formulas. The <code>twoCoprimary</code>
package implements all five methods. Note that Fisher‚Äôs exact test does
not have a closed-form sample size formula and requires simulation-based
power calculation.</p>
</div>
<div class="section level3">
<h3 id="joint-distribution-and-power-calculation">Joint Distribution and Power Calculation<a class="anchor" aria-label="anchor" href="#joint-distribution-and-power-calculation"></a>
</h3>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{H}_{1}</annotation></semantics></math>,
the test statistics
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_{1}, Z_{2})</annotation></semantics></math>
asymptotically follow a bivariate normal distribution. The overall power
is given by (Equation 4 in Sozu et al., 2012):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>Œ≤</mi><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>‚ãÇ</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>k</mi></msub><mo>&gt;</mo><msub><mi>z</mi><mi>Œ±</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚âà</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>‚ãÇ</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>Z</mi><mi>k</mi><mo>*</mo></msubsup><mo>&gt;</mo><msubsup><mi>c</mi><mi>k</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \text{P}\left[\bigcap_{k=1}^{2} \{Z_{k} &gt; z_{\alpha}\}\right] \approx \text{P}\left[\bigcap_{k=1}^{2} \left\{Z_{k}^{*} &gt; c_{k}^{*}\right\}\right]</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Z</mi><mi>k</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>1</mn></msub><mo>‚àí</mo><msub><mover><mi>p</mi><mo accent="true">ÃÇ</mo></mover><mn>2</mn></msub><mo>‚àí</mo><msub><mi>Œî</mi><mi>k</mi></msub></mrow><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_{k}^{*} = \frac{\hat{p}_{1} - \hat{p}_{2} - \Delta_{k}}{se_{k}}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œî</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\Delta_{k}</annotation></semantics></math>
being the treatment effect, and:</p>
<p><strong>For continuous endpoint</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mn>1</mn><mo>*</mo></msubsup><mo>=</mo><msub><mi>z</mi><mi>Œ±</mi></msub><mo>‚àí</mo><mfrac><msub><mi>Œ¥</mi><mn>1</mn></msub><mi>œÉ</mi></mfrac><msqrt><mfrac><mrow><mi>Œ∫</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><mrow><mn>1</mn><mo>+</mo><mi>Œ∫</mi></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">c_{1}^{*} = z_{\alpha} - \frac{\delta_{1}}{\sigma} \sqrt{\frac{\kappa n_{1}}{1+\kappa}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ¥</mi><mn>1</mn></msub><mo>=</mo><msub><mi>Œº</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>Œº</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\delta_{1} = \mu_{1} - \mu_{2}</annotation></semantics></math>
is the effect size for the endpoint 1.</p>
<p><strong>For binary endpoint</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k = 2</annotation></semantics></math>,
AN method) (Equation 5 in Sozu et al., 2012):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mn>2</mn><mo>*</mo></msubsup><mo>=</mo><mfrac><mrow><msqrt><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><mi>Œ∫</mi><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Œ∫</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>Œ∫</mi></mrow></mfrac></msqrt><msub><mi>z</mi><mi>Œ±</mi></msub><mo>‚àí</mo><msqrt><mrow><mi>Œ∫</mi><msub><mi>n</mi><mn>1</mn></msub></mrow></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><mrow><mi>Œ∫</mi><msub><mi>p</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">c_{2}^{*} = \frac{\sqrt{\frac{(p_{1}+\kappa p_{2})\{(1-p_{1})+\kappa(1-p_{2})\}}{1+\kappa}} z_{\alpha} - \sqrt{\kappa n_{1}}(p_{1}-p_{2})}{\sqrt{\kappa p_{1}(1-p_{1})+p_{2}(1-p_{2})}}</annotation></semantics></math></p>
<p>The vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>Z</mi><mn>2</mn><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">T</mtext></msup><annotation encoding="application/x-tex">(Z_{1}^{*}, Z_{2}^{*})^\text{T}</annotation></semantics></math>
is approximately distributed as a standardized bivariate normal
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">N</mtext><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>ùüé</mn><mo>,</mo><mi>Œ≥</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{N}_{2}(\mathbf{0}, \gamma)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is the correlation between the test statistics.</p>
<p><strong>Correlation between test statistics</strong>: For the mixed
continuous and binary case, the correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Z_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Z_{2}</annotation></semantics></math>
depends on the biserial correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
between outcomes. The explicit formula involves the standard normal
density function and success probabilities. See equation (1) in the
Supporting Information of Sozu et al.¬†(2012) for details:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Corr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>œÅ</mi><mi>j</mi></msub><msub><mi>Œæ</mi><mi>j</mi></msub></mrow><msqrt><mrow><msub><mi>p</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\text{Corr}(X_{i,j,1}, X_{i,j,2}) = \frac{\rho_{j} \xi_{j}}{\sqrt{p_{j}(1-p_{j})}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œæ</mi><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>œÄ</mi></mrow></msqrt></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo>‚àí</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>g</mi><mi>j</mi></msub><mo>‚àí</mo><msubsup><mi>Œº</mi><mi>j</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>œÉ</mi><mi>j</mi><mrow><mn>2</mn><mo>*</mo></mrow></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\xi_{j} = \frac{1}{\sqrt{2\pi}} \exp\left\{-\frac{(g_{j} - \mu_{j}^{\ast})^2}{2\sigma_{j}^{2\ast}}\right\}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="sample-size-determination">Sample Size Determination<a class="anchor" aria-label="anchor" href="#sample-size-determination"></a>
</h3>
<p>The sample size is determined by solving the power equation
numerically. For a given allocation ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
target power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>Œ≤</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>,
and significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
we find the smallest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
such that the overall power equals or exceeds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>Œ≤</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>.</p>
<p><strong>Computational approach</strong>:</p>
<ol style="list-style-type: decimal">
<li>Calculate initial sample size based on single-endpoint formulas</li>
<li>Compute the correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
between test statistics using the biserial correlation</li>
<li>Calculate joint power using the bivariate normal distribution</li>
<li>Iterate until target power is achieved</li>
</ol>
<p><strong>Fisher‚Äôs exact test</strong>: For Fisher‚Äôs exact test, the
power calculation is simulation-based due to the discrete nature of the
test statistic. The sample size calculation uses sequential search
starting from the AN method‚Äôs sample size as an initial value.</p>
</div>
</div>
<div class="section level2">
<h2 id="replicating-sozu-et-al--2012-table-2">Replicating Sozu et al.¬†(2012) Table 2<a class="anchor" aria-label="anchor" href="#replicating-sozu-et-al--2012-table-2"></a>
</h2>
<p>Table 2 from Sozu et al.¬†(2012) shows sample sizes for the PREMIER
study scenario with different standard deviations and correlations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recreate Sozu et al. (2012) Table 2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">param_grid_mixed_cb_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.59</span>,</span>
<span>  p2 <span class="op">=</span> <span class="fl">0.46</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_mixed_cb_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design_table.html">design_table</a></span><span class="op">(</span></span>
<span>  param_grid <span class="op">=</span> <span class="va">param_grid_mixed_cb_ss</span>,</span>
<span>  rho_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  endpoint_type <span class="op">=</span> <span class="st">"mixed_cont_binary"</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_mixed_cb_ss</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Table 2: Sample Size per Group (n) for PREMIER Study Scenario (delta1 = 4.4, p1 = 0.59, p2 = 0.46, Œ± = 0.025, 1-Œ≤ = 0.80)"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"œÉ"</span>, <span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"œÅ=0.0"</span>, <span class="st">"œÅ=0.3"</span>, <span class="st">"œÅ=0.5"</span>, <span class="st">"œÅ=0.8"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 2: Sample Size per Group (n) for PREMIER Study Scenario
(delta1 = 4.4, p1 = 0.59, p2 = 0.46, Œ± = 0.025, 1-Œ≤ = 0.80)</caption>
<thead><tr class="header">
<th align="right">delta</th>
<th align="right">œÉ</th>
<th align="right">p1</th>
<th align="right">p2</th>
<th align="right">œÅ=0.0</th>
<th align="right">œÅ=0.3</th>
<th align="right">œÅ=0.5</th>
<th align="right">œÅ=0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">19</td>
<td align="right">0.59</td>
<td align="right">0.46</td>
<td align="right">346</td>
<td align="right">340</td>
<td align="right">334</td>
<td align="right">323</td>
</tr>
<tr class="even">
<td align="right">4.4</td>
<td align="right">20</td>
<td align="right">0.59</td>
<td align="right">0.46</td>
<td align="right">369</td>
<td align="right">363</td>
<td align="right">358</td>
<td align="right">347</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">21</td>
<td align="right">0.59</td>
<td align="right">0.46</td>
<td align="right">394</td>
<td align="right">389</td>
<td align="right">384</td>
<td align="right">374</td>
</tr>
<tr class="even">
<td align="right">4.4</td>
<td align="right">22</td>
<td align="right">0.59</td>
<td align="right">0.46</td>
<td align="right">422</td>
<td align="right">417</td>
<td align="right">413</td>
<td align="right">404</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation</strong>: This table shows that as the
standard deviation increases, the required sample size increases. The
correlation has a modest effect on sample size reduction (approximately
5-7% reduction at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>).</p>
</div>
<div class="section level2">
<h2 id="replicating-sozu-et-al--2012-supporting-information-table-5">Replicating Sozu et al.¬†(2012) Supporting Information Table 5<a class="anchor" aria-label="anchor" href="#replicating-sozu-et-al--2012-supporting-information-table-5"></a>
</h2>
<p>Table 5 from the Supporting Information shows sample sizes for
scenarios with higher success probabilities and different test
methods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recreate Supporting Information Table 5</span></span>
<span><span class="va">param_grid_mixed_cb_ss2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.235</span>, <span class="fl">0.397</span>, <span class="fl">0.521</span>, <span class="fl">0.190</span>, <span class="fl">0.335</span>, <span class="fl">0.457</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.99</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.85</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.80</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_mixed_cb_ss2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  <span class="va">bind_rows</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ANc"</span>, <span class="st">"ASc"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/design_table.html">design_table</a></span><span class="op">(</span></span>
<span>      param_grid <span class="op">=</span> <span class="va">param_grid_mixed_cb_ss2</span>,</span>
<span>      rho_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>      r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>      beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>      endpoint_type <span class="op">=</span> <span class="st">"mixed_cont_binary"</span>,</span>
<span>      Test <span class="op">=</span> <span class="va">test</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>, <span class="va">delta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">delta</span>, <span class="va">sd</span>, <span class="va">p1</span>, <span class="va">p2</span>, <span class="va">Test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display for ANc</span></span>
<span><span class="va">result_anc</span> <span class="op">&lt;-</span> <span class="va">result_mixed_cb_ss2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Test</span> <span class="op">==</span> <span class="st">"ANc"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Test</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_anc</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Table 5 (Part A): Sample Size per Group (n) with Continuity Correction (ANc) (œÉ = 1, Œ± = 0.025, 1-Œ≤ = 0.80)^a^"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"œÉ"</span>, <span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"œÅ=0.0"</span>, <span class="st">"œÅ=0.3"</span>, <span class="st">"œÅ=0.5"</span>, <span class="st">"œÅ=0.8"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 5 (Part A): Sample Size per Group (n) with Continuity
Correction (ANc) (œÉ = 1, Œ± = 0.025, 1-Œ≤ = 0.80)<sup>a</sup>
</caption>
<thead><tr class="header">
<th align="right">delta</th>
<th align="right">œÉ</th>
<th align="right">p1</th>
<th align="right">p2</th>
<th align="right">œÅ=0.0</th>
<th align="right">œÅ=0.3</th>
<th align="right">œÅ=0.5</th>
<th align="right">œÅ=0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.235</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.95</td>
<td align="right">400</td>
<td align="right">397</td>
<td align="right">395</td>
<td align="right">391</td>
</tr>
<tr class="even">
<td align="right">0.397</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.90</td>
<td align="right">143</td>
<td align="right">142</td>
<td align="right">141</td>
<td align="right">139</td>
</tr>
<tr class="odd">
<td align="right">0.521</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.85</td>
<td align="right">84</td>
<td align="right">83</td>
<td align="right">82</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="right">0.190</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.90</td>
<td align="right">592</td>
<td align="right">585</td>
<td align="right">579</td>
<td align="right">569</td>
</tr>
<tr class="odd">
<td align="right">0.335</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.85</td>
<td align="right">195</td>
<td align="right">192</td>
<td align="right">190</td>
<td align="right">187</td>
</tr>
<tr class="even">
<td align="right">0.457</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.80</td>
<td align="right">106</td>
<td align="right">105</td>
<td align="right">104</td>
<td align="right">102</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Display for ASc</span></span>
<span><span class="va">result_asc</span> <span class="op">&lt;-</span> <span class="va">result_mixed_cb_ss2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Test</span> <span class="op">==</span> <span class="st">"ASc"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Test</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_asc</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Table 5 (Part B): Sample Size per Group (n) with Arcsine and Continuity Correction (ASc) (œÉ = 1, Œ± = 0.025, 1-Œ≤ = 0.80)^a^"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"œÉ"</span>, <span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"œÅ=0.0"</span>, <span class="st">"œÅ=0.3"</span>, <span class="st">"œÅ=0.5"</span>, <span class="st">"œÅ=0.8"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 5 (Part B): Sample Size per Group (n) with Arcsine and
Continuity Correction (ASc) (œÉ = 1, Œ± = 0.025, 1-Œ≤ =
0.80)<sup>a</sup>
</caption>
<thead><tr class="header">
<th align="right">delta</th>
<th align="right">œÉ</th>
<th align="right">p1</th>
<th align="right">p2</th>
<th align="right">œÅ=0.0</th>
<th align="right">œÅ=0.3</th>
<th align="right">œÅ=0.5</th>
<th align="right">œÅ=0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.235</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.95</td>
<td align="right">376</td>
<td align="right">373</td>
<td align="right">371</td>
<td align="right">367</td>
</tr>
<tr class="even">
<td align="right">0.397</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.90</td>
<td align="right">129</td>
<td align="right">128</td>
<td align="right">127</td>
<td align="right">125</td>
</tr>
<tr class="odd">
<td align="right">0.521</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.85</td>
<td align="right">74</td>
<td align="right">74</td>
<td align="right">73</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="right">0.190</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.90</td>
<td align="right">585</td>
<td align="right">578</td>
<td align="right">572</td>
<td align="right">562</td>
</tr>
<tr class="odd">
<td align="right">0.335</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.85</td>
<td align="right">189</td>
<td align="right">187</td>
<td align="right">185</td>
<td align="right">182</td>
</tr>
<tr class="even">
<td align="right">0.457</td>
<td align="right">1</td>
<td align="right">0.95</td>
<td align="right">0.80</td>
<td align="right">102</td>
<td align="right">101</td>
<td align="right">100</td>
<td align="right">98</td>
</tr>
</tbody>
</table>
<p><sup>a</sup> Some values may differ slightly from the Supporting
Information Table 5 in Sozu et al.¬†(2012) due to numerical differences
in computing the bivariate normal cumulative distribution function
between SAS and R implementations.</p>
<p><strong>Key findings</strong>:</p>
<ul>
<li>ANc and ASc give similar sample sizes</li>
<li>Correlation effect is modest for these scenarios</li>
<li>Higher success probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_{1}</annotation></semantics></math>)
generally require larger sample sizes when the effect size is small</li>
</ul>
</div>
<div class="section level2">
<h2 id="basic-usage-examples">Basic Usage Examples<a class="anchor" aria-label="anchor" href="#basic-usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-balanced-design">Example 1: Balanced Design<a class="anchor" aria-label="anchor" href="#example-1-balanced-design"></a>
</h3>
<p>Calculate sample size for a balanced design with moderate effect
sizes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Balanced design: nT = nC (i.e., r = 1, which corresponds to kappa = 1)</span></span>
<span><span class="va">result_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,           <span class="co"># Standardized effect for continuous endpoint</span></span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,                <span class="co"># Standard deviation</span></span>
<span>  p1 <span class="op">=</span> <span class="fl">0.7</span>,              <span class="co"># Success prob in treatment group</span></span>
<span>  p2 <span class="op">=</span> <span class="fl">0.5</span>,              <span class="co"># Success prob in control group</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,             <span class="co"># Biserial correlation</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Balanced allocation (r = nT/nC = 1)</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for mixed continuous and binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 102</span></span>
<span><span class="co">#&gt;              n2 = 102</span></span>
<span><span class="co">#&gt;               N = 204</span></span>
<span><span class="co">#&gt;           delta = 0.5</span></span>
<span><span class="co">#&gt;              sd = 1</span></span>
<span><span class="co">#&gt;               p = 0.7, 0.5</span></span>
<span><span class="co">#&gt;             rho = 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span></code></pre></div>
<p><strong>Note</strong>: In the function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r = n_{1}/n_{2}</annotation></semantics></math>.
Thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>
corresponds to balanced allocation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_{1} = n_{2}</annotation></semantics></math>),
which is equivalent to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa = 1</annotation></semantics></math>
in Sozu et al.¬†(2012).</p>
</div>
<div class="section level3">
<h3 id="example-2-effect-of-correlation">Example 2: Effect of Correlation<a class="anchor" aria-label="anchor" href="#example-2-effect-of-correlation"></a>
</h3>
<p>Demonstrate how biserial correlation affects sample size:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed effect sizes</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Range of correlations</span></span>
<span><span class="va">rho_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_by_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    p1 <span class="op">=</span> <span class="va">p1</span>,</span>
<span>    p2 <span class="op">=</span> <span class="va">p2</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">result</span><span class="op">$</span><span class="va">n2</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rho <span class="op">=</span> <span class="va">rho_values</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="va">ss_by_rho</span>,</span>
<span>  N_total <span class="op">=</span> <span class="va">ss_by_rho</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>  reduction_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ss_by_rho</span> <span class="op">/</span> <span class="va">ss_by_rho</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_df</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Effect of Biserial Correlation on Sample Size"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"œÅ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span>, <span class="st">"Reduction (%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Effect of Biserial Correlation on Sample Size</caption>
<thead><tr class="header">
<th align="right">œÅ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
<th align="right">Reduction (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">104</td>
<td align="right">208</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">103</td>
<td align="right">206</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">102</td>
<td align="right">204</td>
<td align="right">1.9</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">99</td>
<td align="right">198</td>
<td align="right">4.8</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="va">ss_by_rho</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Biserial Correlation (œÅ)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Sample size per group (n)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Effect of Correlation on Sample Size"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ss_by_rho</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="mixed-continuous-binary_files/figure-html/example2-1.png" class="r-plt" width="672"></p>
<p><strong>Interpretation</strong>: Higher positive correlation reduces
required sample size. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>,
sample size is reduced by approximately 5-8% compared to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="example-3-comparison-of-test-methods">Example 3: Comparison of Test Methods<a class="anchor" aria-label="anchor" href="#example-3-comparison-of-test-methods"></a>
</h3>
<p>Compare different test methods for the binary endpoint:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed design parameters</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="va">test_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AN"</span>, <span class="st">"ANc"</span>, <span class="st">"AS"</span>, <span class="st">"ASc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">test_methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">test_method</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    p1 <span class="op">=</span> <span class="va">p1</span>,</span>
<span>    p2 <span class="op">=</span> <span class="va">p2</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    Test <span class="op">=</span> <span class="va">test_method</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Test_method <span class="op">=</span> <span class="va">test_method</span>,</span>
<span>    n_per_group <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>    N_total <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">N</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">test_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">test_comparison_table</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison of Test Methods for Binary Endpoint"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Test Method"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of Test Methods for Binary Endpoint</caption>
<thead><tr class="header">
<th align="left">Test Method</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AN</td>
<td align="right">102</td>
<td align="right">204</td>
</tr>
<tr class="even">
<td align="left">ANc</td>
<td align="right">109</td>
<td align="right">218</td>
</tr>
<tr class="odd">
<td align="left">AS</td>
<td align="right">101</td>
<td align="right">202</td>
</tr>
<tr class="even">
<td align="left">ASc</td>
<td align="right">109</td>
<td align="right">218</td>
</tr>
</tbody>
</table>
<p><strong>Key findings</strong>:</p>
<ul>
<li>
<strong>AN</strong> (no continuity correction): Similar to AS</li>
<li>
<strong>ANc</strong> (with continuity correction): Slightly larger
(~1-5% increase)</li>
<li>
<strong>AS</strong> (arcsine): Smallest sample size</li>
<li>
<strong>ASc</strong> (arcsine with CC): Similar to ANc</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-4-unbalanced-allocation">Example 4: Unbalanced Allocation<a class="anchor" aria-label="anchor" href="#example-4-unbalanced-allocation"></a>
</h3>
<p>Calculate sample size with 2:1 allocation ratio:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Balanced design (r = 1, equivalent to kappa = 1)</span></span>
<span><span class="va">result_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unbalanced design (r = 2, i.e., nT = 2*nC, equivalent to kappa = 0.5)</span></span>
<span><span class="va">result_unbalanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_allocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Balanced (1:1)"</span>, <span class="st">"Unbalanced (2:1)"</span><span class="op">)</span>,</span>
<span>  n_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">n1</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">n1</span><span class="op">)</span>,</span>
<span>  n_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">n2</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span>,</span>
<span>  N_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison_allocation</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison: Balanced vs Unbalanced Allocation"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Design"</span>, <span class="st">"nT"</span>, <span class="st">"nC"</span>, <span class="st">"N total"</span>, <span class="st">"Œ∫"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison: Balanced vs Unbalanced Allocation</caption>
<thead><tr class="header">
<th align="left">Design</th>
<th align="right">nT</th>
<th align="right">nC</th>
<th align="right">N total</th>
<th align="right">Œ∫</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Balanced (1:1)</td>
<td align="right">102</td>
<td align="right">102</td>
<td align="right">204</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">Unbalanced (2:1)</td>
<td align="right">152</td>
<td align="right">76</td>
<td align="right">228</td>
<td align="right">0.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nIncrease in total sample size:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">result_unbalanced</span><span class="op">$</span><span class="va">N</span> <span class="op">-</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span><span class="op">)</span> <span class="op">/</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Increase in total sample size: 11.8 %</span></span></code></pre></div>
<p><strong>Note</strong>: In the function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r = n_{1}/n_{2}</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">r = 2</annotation></semantics></math>
means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mo>√ó</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_{1} = 2 \times n_{2}</annotation></semantics></math>,
which corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\kappa = n_{2}/n_{1} = 0.5</annotation></semantics></math>
in Sozu et al.¬†(2012) notation.</p>
</div>
</div>
<div class="section level2">
<h2 id="power-verification">Power Verification<a class="anchor" aria-label="anchor" href="#power-verification"></a>
</h2>
<p>Verify that calculated sample sizes achieve target power:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use result from Example 1</span></span>
<span><span class="va">power_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power2MixedContinuousBinary.html">power2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>  n1 <span class="op">=</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>  n2 <span class="op">=</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target power: 0.80\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target power: 0.80</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Continuous endpoint):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Continuous endpoint):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Binary endpoint):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power2</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Binary endpoint):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Co-primary):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">powerCoprimary</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Co-primary): 0.8044</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="design-considerations">Design Considerations<a class="anchor" aria-label="anchor" href="#design-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Estimating biserial correlation</strong>: Use pilot data
or historical studies; be conservative if uncertain. Biserial
correlation is more challenging to estimate than Pearson
correlation.</p></li>
<li><p><strong>Latent variable assumption</strong>: Ensure the binary
endpoint conceptually has an underlying continuous scale (e.g.,
‚Äúimproved‚Äù means crossing a threshold on a continuous improvement
scale).</p></li>
<li>
<p><strong>Test method selection</strong>:</p>
<ul>
<li>
<strong>AN</strong>: Most common, smallest sample size</li>
<li>
<strong>ANc</strong>: Adds continuity correction for
conservatism</li>
<li>
<strong>AS</strong>: Uses arcsine transformation for variance
stabilization</li>
<li>
<strong>ASc</strong>: Combines arcsine transformation with
continuity correction</li>
<li>
<strong>Fisher</strong>: Provides exact inference but
computationally intensive</li>
</ul>
</li>
<li><p><strong>Balanced allocation</strong>: Generally most efficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa = 1</annotation></semantics></math>,
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>)
unless practical constraints require otherwise.</p></li>
<li><p><strong>Sensitivity analysis</strong>: Calculate for range of
plausible correlations and effect sizes.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-this-method">When to Use This Method<a class="anchor" aria-label="anchor" href="#when-to-use-this-method"></a>
</h3>
<p>Use mixed continuous-binary methods when:</p>
<ul>
<li>One endpoint is naturally continuous (e.g., change in test
score)</li>
<li>Other endpoint is naturally binary (e.g., clinical response
yes/no)</li>
<li>Both endpoints are clinically meaningful co-primary endpoints</li>
<li>Sample sizes are moderate to large
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N &gt; 50</annotation></semantics></math>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="challenges-and-considerations">Challenges and Considerations<a class="anchor" aria-label="anchor" href="#challenges-and-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Correlation estimation</strong>: Biserial correlation
involves a latent variable and is harder to estimate than Pearson
correlation</p></li>
<li><p><strong>Threshold specification</strong>: The dichotomization
threshold affects correlation; ensure it‚Äôs clinically
meaningful</p></li>
<li><p><strong>Asymmetric power</strong>: Mixed endpoints often have
unequal power for the two endpoints; the endpoint with lower power
dominates sample size</p></li>
<li><p><strong>Asymptotic approximation</strong>: Methods rely on
asymptotic normality; may not be accurate for very small samples
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N &lt; 50</annotation></semantics></math>)</p></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2012). Sample size
determination in clinical trials with multiple co-primary endpoints
including mixed continuous and binary variables. <em>Biometrical
Journal</em>, 54(5), 716-729.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  
</body>
</html>
