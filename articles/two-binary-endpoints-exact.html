<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Two Binary Co-Primary Endpoints (Exact Methods) • twoCoprimary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two Binary Co-Primary Endpoints (Exact Methods)">
</head>
<body>
<p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Two Binary Co-Primary Endpoints (Exact Methods)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/vignettes/two-binary-endpoints-exact.Rmd" class="external-link"><code>vignettes/two-binary-endpoints-exact.Rmd</code></a></small>
      <div class="d-none name"><code>two-binary-endpoints-exact.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates exact sample size calculation and power
analysis for clinical trials with two co-primary binary endpoints. The
methodology is based on Homma and Yoshida (2025), which provides exact
inference methods using the bivariate binomial distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaEX.github.io/twoCoprimary">twoCoprimary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="when-to-use-exact-methods">When to Use Exact Methods<a class="anchor" aria-label="anchor" href="#when-to-use-exact-methods"></a>
</h3>
<p>Exact methods are recommended when:</p>
<ul>
<li>
<strong>Small to medium sample sizes</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &lt; 200</annotation></semantics></math>)</li>
<li>
<strong>Extreme probabilities</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.10</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">p &gt; 0.90</annotation></semantics></math>)</li>
<li>
<strong>Strict Type I error control</strong> is required</li>
<li>
<strong>Regulatory requirements</strong> for exact inference</li>
</ul>
<p>Asymptotic methods may not maintain the nominal Type I error rate in
these situations.</p>
</div>
<div class="section level3">
<h3 id="advantages-of-exact-methods">Advantages of Exact Methods<a class="anchor" aria-label="anchor" href="#advantages-of-exact-methods"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Accurate Type I error control</strong>: Exact tests
guarantee
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>≤</mo></mrow><annotation encoding="application/x-tex">\alpha \leq</annotation></semantics></math>
nominal level</li>
<li>
<strong>Better small-sample performance</strong>: No reliance on
asymptotic approximations</li>
<li>
<strong>Valid for extreme probabilities</strong>: No restrictions on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
values</li>
<li>
<strong>Regulatory acceptance</strong>: Often preferred by
regulatory agencies</li>
</ol>
</div>
<div class="section level3">
<h3 id="disadvantages">Disadvantages<a class="anchor" aria-label="anchor" href="#disadvantages"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Computational intensity</strong>: Requires enumeration of
possible outcomes</li>
<li>
<strong>Conservatism</strong>: Discrete nature can lead to
conservatism</li>
<li>
<strong>Implementation complexity</strong>: More complex than
asymptotic methods</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h2>
<div class="section level3">
<h3 id="model-and-assumptions">Model and Assumptions<a class="anchor" aria-label="anchor" href="#model-and-assumptions"></a>
</h3>
<p>Consider a two-arm parallel-group superiority trial comparing
treatment (group 1) with control (group 2). Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
denote the sample sizes in groups 1 and 2, respectively.</p>
<p>For patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j = 1</annotation></semantics></math>:
treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">j = 2</annotation></semantics></math>:
control), we observe two binary outcomes:</p>
<p><strong>Endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math></strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k = 1, 2</annotation></semantics></math>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">X_{i,j,k} \in \{0, 1\}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_{i,j,k} = 1</annotation></semantics></math>
if patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is a responder for endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
and 0 otherwise.</p>
<p><strong>True response probabilities</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{j,k} = \text{P}(X_{i,j,k} = 1)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; p_{j,k} &lt; 1</annotation></semantics></math>
for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="joint-distribution-of-binary-outcomes">Joint Distribution of Binary Outcomes<a class="anchor" aria-label="anchor" href="#joint-distribution-of-binary-outcomes"></a>
</h3>
<p>The paired binary outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_{i,j,1}, X_{i,j,2})</annotation></semantics></math>
for patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
follow a multinomial distribution with four possible outcomes:</p>
<p><strong>Per-trial probabilities</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mi>ϕ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p_{j}^{(1,1)} = \phi_{j}</annotation></semantics></math>:
Both endpoints successful</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>ϕ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p_{j}^{(1,0)} = p_{j,1} - \phi_{j}</annotation></semantics></math>:
Only endpoint 1 successful</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>−</mo><msub><mi>ϕ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p_{j}^{(0,1)} = p_{j,2} - \phi_{j}</annotation></semantics></math>:
Only endpoint 2 successful</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>ϕ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p_{j}^{(0,0)} = 1 - p_{j,1} - p_{j,2} + \phi_{j}</annotation></semantics></math>:
Both endpoints unsuccessful</li>
</ul>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_{j} = \text{P}(X_{i,j,1} = 1, X_{i,j,2} = 1)</annotation></semantics></math>.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>ℓ</mo><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">Z_{j}^{(\ell,m)}</annotation></semantics></math>
denote the random variable representing the number of times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>n</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{(X_{i,j,1}, X_{i,j,2}) : i = 1, \ldots, n_{j}\}</annotation></semantics></math>
takes the value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mo>ℓ</mo><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\ell, m)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mo>,</mo><mi>m</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\ell, m \in \{0, 1\}</annotation></semantics></math>.
Then:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">Multinomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>j</mi></msub><mo>;</mo><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>p</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(Z_{j}^{(0,0)}, Z_{j}^{(1,0)}, Z_{j}^{(0,1)}, Z_{j}^{(1,1)}) \sim \text{Multinomial}(n_{j}; p_{j}^{(0,0)}, p_{j}^{(1,0)}, p_{j}^{(0,1)}, p_{j}^{(1,1)})</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="number-of-responders">Number of Responders<a class="anchor" aria-label="anchor" href="#number-of-responders"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>j</mi></msub></msubsup><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{j,k} = \sum_{i=1}^{n_{j}} X_{i,j,k}</annotation></semantics></math>
represent the number of responders in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
for endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
Then:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">Y_{j,1} = Z_{j}^{(1,1)} + Z_{j}^{(1,0)}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Z</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">Y_{j,2} = Z_{j}^{(1,1)} + Z_{j}^{(0,1)}</annotation></semantics></math></li>
</ul>
</div>
<div class="section level3">
<h3 id="bivariate-binomial-distribution">Bivariate Binomial Distribution<a class="anchor" aria-label="anchor" href="#bivariate-binomial-distribution"></a>
</h3>
<p>Following Homma and Yoshida (2025), the joint distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Y_{j,1}, Y_{j,2})</annotation></semantics></math>
can be expressed as a <strong>bivariate binomial
distribution</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">BiBin</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(Y_{j,1}, Y_{j,2}) \sim \text{BiBin}(n_{j}, p_{j,1}, p_{j,2}, \gamma_{j})</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_{j}</annotation></semantics></math>
is a dependence parameter related to the correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,2}</annotation></semantics></math>.</p>
<p><strong>Probability mass function</strong> (Equation 3 in Homma and
Yoshida, 2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>∣</mo><msub><mi>n</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>n</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>∣</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>n</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{P}(Y_{j,1} = y_{j,1}, Y_{j,2} = y_{j,2} \mid n_{j}, p_{j,1}, p_{j,2}, \gamma_{j}) = f(y_{j,1} \mid n_{j}, p_{j,1}) \times g(y_{j,2} \mid y_{j,1}, n_{j}, p_{j,1}, p_{j,2}, \gamma_{j})</annotation></semantics></math>
For more details, please see Homma and Yoshida (2025).</p>
</div>
<div class="section level3">
<h3 id="correlation-structure">Correlation Structure<a class="anchor" aria-label="anchor" href="#correlation-structure"></a>
</h3>
<p>The <strong>correlation</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,2}</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>j</mi></msub><mo>=</mo><mtext mathvariant="normal">Cor</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><msqrt><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\rho_{j} = \text{Cor}(X_{i,j,1}, X_{i,j,2}) = \frac{\phi_{j} - p_{j,1} p_{j,2}}{\sqrt{p_{j,1}(1 - p_{j,1}) p_{j,2}(1 - p_{j,2})}}</annotation></semantics></math></p>
<p>The dependence parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_{j}</annotation></semantics></math>
is related to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
through (Equation 4 in Homma and Yoshida, 2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>j</mi></msub><mo>=</mo><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ρ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ρ</mi><mi>j</mi></msub><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>ρ</mi><mi>j</mi></msub><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\gamma_{j} = \gamma(\rho_{j}, p_{j,1}, p_{j,2}) = \rho_{j} \sqrt{\frac{p_{j,2}(1 - p_{j,2})}{p_{j,1}(1 - p_{j,1})}} \left(1 - \rho_{j} \sqrt{\frac{p_{j,2}(1 - p_{j,2})}{p_{j,1}(1 - p_{j,1})}}\right)^{-1}</annotation></semantics></math></p>
<p><strong>Important property</strong>: The correlation between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">Y_{j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">Y_{j,2}</annotation></semantics></math>
equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>,
the same as the correlation between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">X_{i,j,2}</annotation></semantics></math>.</p>
<p><strong>Marginal distributions</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Bin</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>j</mi></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{j,k} \sim \text{Bin}(n_{j}, p_{j,k})</annotation></semantics></math></p>
<p><strong>Correlation bounds</strong>: Due to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; p_{j,k} &lt; 1</annotation></semantics></math>,
the correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
is bounded:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>j</mi></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>⊆</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{j} \in [L(p_{j,1}, p_{j,2}), U(p_{j,1}, p_{j,2})] \subseteq [-1, 1]</annotation></semantics></math></p>
<p>where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo>−</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo>,</mo><mo>−</mo><msqrt><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">L(p_{j,1}, p_{j,2}) = \max\left\{-\sqrt{\frac{p_{j,1} p_{j,2}}{(1 - p_{j,1})(1 - p_{j,2})}}, -\sqrt{\frac{(1 - p_{j,1})(1 - p_{j,2})}{p_{j,1} p_{j,2}}}\right\}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">{</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo>,</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">U(p_{j,1}, p_{j,2}) = \min\left\{\sqrt{\frac{p_{j,1}(1 - p_{j,2})}{p_{j,2}(1 - p_{j,1})}}, \sqrt{\frac{p_{j,2}(1 - p_{j,1})}{p_{j,1}(1 - p_{j,2})}}\right\}</annotation></semantics></math></p>
<p><strong>Special cases</strong>: - If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{j,1} = p_{j,2}</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">U(p_{j,1}, p_{j,2}) = 1</annotation></semantics></math>
- If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_{j,1} + p_{j,2} = 1</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L(p_{j,1}, p_{j,2}) = -1</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<div class="section level3">
<h3 id="superiority-hypotheses">Superiority Hypotheses<a class="anchor" aria-label="anchor" href="#superiority-hypotheses"></a>
</h3>
<p>Since higher values of both endpoints indicate treatment benefit, we
test:</p>
<p><strong>For endpoint 1</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>≤</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msubsup><mtext mathvariant="normal">H</mtext><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>&gt;</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{H}_{0}^{(1)}: p_{1,1} \leq p_{2,1} \text{ vs. } \text{H}_{1}^{(1)}: p_{1,1} &gt; p_{2,1}</annotation></semantics></math></p>
<p><strong>For endpoint 2</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>≤</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msubsup><mtext mathvariant="normal">H</mtext><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>&gt;</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{H}_{0}^{(2)}: p_{1,2} \leq p_{2,2} \text{ vs. } \text{H}_{1}^{(2)}: p_{1,2} &gt; p_{2,2}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="co-primary-endpoints-intersection-union-test">Co-Primary Endpoints (Intersection-Union Test)<a class="anchor" aria-label="anchor" href="#co-primary-endpoints-intersection-union-test"></a>
</h3>
<p>The trial succeeds only if superiority is demonstrated for
<strong>both</strong> endpoints simultaneously:</p>
<p><strong>Null hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>=</mo><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>∪</mo><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\text{H}_{0} = \text{H}_{0}^{(1)} \cup \text{H}_{0}^{(2)}</annotation></semantics></math>
(at least one null is true)</p>
<p><strong>Alternative hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo>=</mo><msubsup><mtext mathvariant="normal">H</mtext><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>∩</mo><msubsup><mtext mathvariant="normal">H</mtext><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\text{H}_{1} = \text{H}_{1}^{(1)} \cap \text{H}_{1}^{(2)}</annotation></semantics></math>
(both alternatives are true)</p>
<p><strong>Decision rule</strong>: Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
if and only if <strong>both</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\text{H}_{0}^{(1)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\text{H}_{0}^{(2)}</annotation></semantics></math>
are rejected at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
without multiplicity adjustment.</p>
</div>
</div>
<div class="section level2">
<h2 id="statistical-tests">Statistical Tests<a class="anchor" aria-label="anchor" href="#statistical-tests"></a>
</h2>
<p>Homma and Yoshida (2025) consider five exact test methods:</p>
<div class="section level3">
<h3 id="method-1-one-sided-pearson-chi-squared-test-chisq">Method 1: One-sided Pearson Chi-squared Test (Chisq)<a class="anchor" aria-label="anchor" href="#method-1-one-sided-pearson-chi-squared-test-chisq"></a>
</h3>
<p>For endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
the test statistic is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><msqrt><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z(y_{1,k}, y_{2,k}) = \frac{\hat{p}_{1,k} - \hat{p}_{2,k}}{\sqrt{\hat{p}_{k}(1 - \hat{p}_{k})\left(\frac{1}{n_{1}} + \frac{1}{n_{2}}\right)}}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mi>/</mi><msub><mi>n</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{p}_{j,k} = y_{j,k} / n_{j}</annotation></semantics></math>
is the sample proportion</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mn>1</mn></msub><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{p}_{k} = \frac{n_{1} \hat{p}_{1,k} + n_{2} \hat{p}_{2,k}}{n_{1} + n_{2}}</annotation></semantics></math>
is the pooled proportion</li>
</ul>
<p>Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\text{H}_{0}^{(k)}</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z(y_{1,k}, y_{2,k}) &gt; z_{1-\alpha}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><annotation encoding="application/x-tex">z_{1-\alpha}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\alpha)</annotation></semantics></math>-quantile
of the standard normal distribution.</p>
</div>
<div class="section level3">
<h3 id="method-2-fishers-exact-test-fisher">Method 2: Fisher’s Exact Test (Fisher)<a class="anchor" aria-label="anchor" href="#method-2-fishers-exact-test-fisher"></a>
</h3>
<p><strong>Conditional test</strong>: Conditions on the total number of
successes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{1,k} + y_{2,k}</annotation></semantics></math>.</p>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\text{H}_{0}^{(k)}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">Y_{1,k}</annotation></semantics></math>
follows a hypergeometric distribution given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>Y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Y_{1,k} + Y_{2,k} = y_{k}</annotation></semantics></math>.</p>
<p><strong>One-sided p-value</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>k</mi><mtext mathvariant="normal">Fisher</mtext></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>y</mi><mo>=</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><mrow><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></munderover><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><msub><mi>n</mi><mn>1</mn></msub><mi>y</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><msub><mi>n</mi><mn>2</mn></msub><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><mi>y</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><msub><mi>y</mi><mi>k</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{k}^{\text{Fisher}} = \sum_{y=y_{1,k}}^{\min(n_{1}, y_{k})} \frac{\binom{n_{1}}{y} \binom{n_{2}}{y_{k} - y}}{\binom{n_{1} + n_{2}}{y_{k}}}</annotation></semantics></math></p>
<p>Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">H</mtext><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\text{H}_{0}^{(k)}</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>k</mi><mtext mathvariant="normal">Fisher</mtext></msubsup><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p_{k}^{\text{Fisher}} &lt; \alpha</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="method-3-fishers-mid-p-test-fisher-midp">Method 3: Fisher’s Mid-P Test (Fisher-midP)<a class="anchor" aria-label="anchor" href="#method-3-fishers-mid-p-test-fisher-midp"></a>
</h3>
<p>Reduces conservatism by adding half the probability of the observed
outcome:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>k</mi><mtext mathvariant="normal">mid-p</mtext></msubsup><mo>=</mo><msubsup><mi>p</mi><mi>k</mi><mtext mathvariant="normal">Fisher</mtext></msubsup><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>×</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><msub><mi>n</mi><mn>1</mn></msub><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><msub><mi>n</mi><mn>2</mn></msub><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><msub><mi>y</mi><mi>k</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{k}^{\text{mid-p}} = p_{k}^{\text{Fisher}} - \frac{1}{2} \times \frac{\binom{n_{1}}{y_{1,k}} \binom{n_{2}}{y_{k} - y_{1,k}}}{\binom{n_{1} + n_{2}}{y_{k}}}</annotation></semantics></math>
Note: The <code>twoCoprimary</code> package can implement the Fisher’s
Mid-P Test, but Homma and Yoshida (2025) has not investigated this
test.</p>
</div>
<div class="section level3">
<h3 id="method-4-z-pooled-exact-unconditional-test-z-pool">Method 4: Z-pooled Exact Unconditional Test (Z-pool)<a class="anchor" aria-label="anchor" href="#method-4-z-pooled-exact-unconditional-test-z-pool"></a>
</h3>
<p><strong>Unconditional test</strong>: Maximizes the p-value over all
possible values of the nuisance parameter (common success probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_{k}</annotation></semantics></math>
under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>).</p>
<p>Uses the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>-test
statistic and finds the maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
across all possible values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_{k}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="method-5-boschloos-exact-unconditional-test-boschloo">Method 5: Boschloo’s Exact Unconditional Test (Boschloo)<a class="anchor" aria-label="anchor" href="#method-5-boschloos-exact-unconditional-test-boschloo"></a>
</h3>
<p>Similar to Z-pooled, but based on Fisher’s exact
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values.
Maximizes Fisher’s exact
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
over the nuisance parameter space.</p>
<p><strong>Most powerful</strong> of the exact unconditional tests, but
computationally intensive.</p>
</div>
</div>
<div class="section level2">
<h2 id="exact-power-calculation">Exact Power Calculation<a class="anchor" aria-label="anchor" href="#exact-power-calculation"></a>
</h2>
<div class="section level3">
<h3 id="power-formula">Power Formula<a class="anchor" aria-label="anchor" href="#power-formula"></a>
</h3>
<p>The exact power for test method
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is (Equation 9 in Homma and Yoshida, 2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">power</mtext><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>⋂</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>p</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi><mo stretchy="false" form="postfix">}</mo><mo>∣</mo><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\text{power}_{A}(\boldsymbol{\theta}) = \text{P}\left[\bigcap_{k=1}^{2} \{p_{A}(y_{1,k}, y_{2,k}) &lt; \alpha\} \mid \text{H}_{1}\right]</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><munder><mo>∑</mo><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msub><mi>𝒜</mi><mn>1</mn></msub></mrow></munder><munder><mo>∑</mo><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msub><mi>𝒜</mi><mn>2</mn></msub></mrow></munder><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>n</mi><mn>2</mn></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>∣</mo><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>∣</mo><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">= \sum_{(a_{1,1}, a_{2,1}) \in \mathcal{A}_{1}} \sum_{(a_{1,2}, a_{2,2}) \in \mathcal{A}_{2}} f(a_{1,1} \mid n_{1}, p_{1,1}) \times f(a_{2,1} \mid n_{2}, p_{2,1}) \times g(a_{1,2} \mid a_{1,1}, n_{1}, p_{1,1}, p_{1,2}, \gamma_{1}) \times g(a_{2,2} \mid a_{2,1}, n_{2}, p_{2,1}, p_{2,2}, \gamma_{2})</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (p_{1,1}, p_{2,1}, p_{1,2}, p_{2,2}, n_{1}, n_{2}, \gamma_{1}, \gamma_{2})</annotation></semantics></math>
is the parameter vector</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝒜</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{A}_{k}</annotation></semantics></math>
is the rejection region for endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝒜</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><msub><mi>p</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{A}_{k} = \{(y_{1,k}, y_{2,k}) : p_{A}(y_{1,k}, y_{2,k}) &lt; \alpha\}</annotation></semantics></math></li>
</ul>
</div>
<div class="section level3">
<h3 id="sample-size-calculation">Sample Size Calculation<a class="anchor" aria-label="anchor" href="#sample-size-calculation"></a>
</h3>
<p>The required sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
to achieve target power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>
is (Equation 10 in Homma and Yoshida, 2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>∈</mo><mi>ℤ</mi></mrow></munder><mo stretchy="false" form="prefix">{</mo><msub><mtext mathvariant="normal">power</mtext><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">n_{2} = \arg\min_{n_{2} \in \mathbb{Z}} \{\text{power}_{A}(\boldsymbol{\theta}) \geq 1 - \beta\}</annotation></semantics></math></p>
<p>This cannot be expressed as a closed-form formula due to:</p>
<ol style="list-style-type: decimal">
<li>Discreteness of binary outcomes</li>
<li>Non-monotonic “sawtooth” power curve</li>
</ol>
<p><strong>Algorithm</strong>: Sequential search starting from
asymptotic normal approximation (AN method) as initial value.</p>
</div>
</div>
<div class="section level2">
<h2 id="replicating-homma-and-yoshida-2025-table-4">Replicating Homma and Yoshida (2025) Table 4<a class="anchor" aria-label="anchor" href="#replicating-homma-and-yoshida-2025-table-4"></a>
</h2>
<p>Table 4 from Homma and Yoshida (2025) shows sample sizes for various
correlations using the Chisq, Fisher, Z-pool, and Boschloo. Note that
the following sample code compute only scenario for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.025</mn></mrow><annotation encoding="application/x-tex">\alpha=0.025</annotation></semantics></math>.</p>
<p>The notation used in the function is: <code>p11</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,1}</annotation></semantics></math>,
<code>p12</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,2}</annotation></semantics></math>,
<code>p21</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,1}</annotation></semantics></math>,
<code>p22</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,2}</annotation></semantics></math>,
where the first subscript denotes the group (1 = treatment, 2 = control)
and the second subscript denotes the endpoint (1 or 2).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recreate Homma and Yoshida (2025) Table 4</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">param_grid_bin_exact_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.54</span>, </span>
<span>  p12 <span class="op">=</span> <span class="fl">0.54</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  p22 <span class="op">=</span> <span class="fl">0.25</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_bin_exact_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  <span class="va">bind_rows</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chisq"</span>, <span class="st">"Fisher"</span>, <span class="st">"Z-pool"</span>, <span class="st">"Boschloo"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="va">bind_rows</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/design_table.html">design_table</a></span><span class="op">(</span></span>
<span>          param_grid <span class="op">=</span> <span class="va">param_grid_bin_exact_ss</span>,</span>
<span>          rho_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>          r <span class="op">=</span> <span class="va">r</span>,</span>
<span>          alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>          beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>          endpoint_type <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>          Test <span class="op">=</span> <span class="va">test</span></span>
<span>        <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.025</span>, r <span class="op">=</span> <span class="va">r</span>, Test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"rho"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"N"</span>,</span>
<span>    names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="va">parse_number</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">rho</span>, <span class="va">Test</span>, <span class="va">N</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Test</span>,  values_from <span class="op">=</span> <span class="va">N</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_bin_exact_ss</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Table 4: Total Sample Size (N) for Two Co-Primary Binary Endpoints (α = 0.025, 1-β = 0.90)^a,b^"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"ρ"</span>, <span class="st">"Chisq"</span>, <span class="st">"Fisher"</span>, <span class="st">"Z-pool"</span>, <span class="st">"Boschloo"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 4: Total Sample Size (N) for Two Co-Primary Binary
Endpoints (α = 0.025, 1-β = 0.90)<sup>a,b</sup>
</caption>
<thead><tr class="header">
<th align="right">r</th>
<th align="right">ρ</th>
<th align="right">Chisq</th>
<th align="right">Fisher</th>
<th align="right">Z-pool</th>
<th align="right">Boschloo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.0</td>
<td align="right">142</td>
<td align="right">152</td>
<td align="right">144</td>
<td align="right">144</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.3</td>
<td align="right">142</td>
<td align="right">150</td>
<td align="right">142</td>
<td align="right">142</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.5</td>
<td align="right">140</td>
<td align="right">150</td>
<td align="right">140</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.8</td>
<td align="right">128</td>
<td align="right">144</td>
<td align="right">134</td>
<td align="right">134</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.0</td>
<td align="right">162</td>
<td align="right">174</td>
<td align="right">180</td>
<td align="right">162</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.3</td>
<td align="right">159</td>
<td align="right">174</td>
<td align="right">180</td>
<td align="right">159</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.5</td>
<td align="right">156</td>
<td align="right">171</td>
<td align="right">177</td>
<td align="right">156</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.8</td>
<td align="right">147</td>
<td align="right">159</td>
<td align="right">168</td>
<td align="right">150</td>
</tr>
</tbody>
</table>
<p><sup>a</sup> Chisq denotes the one-sided Pearson chi-squared test.
Fisher stands for Fisher’s exact test. Z-pool represents the Z-pooled
exact unconditional test. Boschloo signifies Boschloo’s exact
unconditional test.</p>
<p><sup>b</sup> The required sample sizes were obtained by assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>0.54</mn></mrow><annotation encoding="application/x-tex">p_{1,1} = p_{1,2} = 0.54</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">p_{2,1} = p_{2,2} = 0.25</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="practical-examples">Practical Examples<a class="anchor" aria-label="anchor" href="#practical-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-basic-exact-power-calculation">Example 1: Basic Exact Power Calculation<a class="anchor" aria-label="anchor" href="#example-1-basic-exact-power-calculation"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate exact power using Fisher's exact test</span></span>
<span><span class="va">result_fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power2BinaryExact.html">power2BinaryExact</a></span><span class="op">(</span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  p11 <span class="op">=</span> <span class="fl">0.70</span>, p12 <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.50</span>, p22 <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"Fisher"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_fisher</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 50</span></span>
<span><span class="co">#&gt;              n2 = 50</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.65</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.5, 0.45</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            Test = Fisher</span></span>
<span><span class="co">#&gt;          power1 = 0.46345</span></span>
<span><span class="co">#&gt;          power2 = 0.46196</span></span>
<span><span class="co">#&gt;  powerCoprimary = 0.297231</span></span></code></pre></div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>
<code>power1</code>: Power for endpoint 1 alone</li>
<li>
<code>power2</code>: Power for endpoint 2 alone</li>
<li>
<code>powerCoprimary</code>: Exact power for both co-primary
endpoints</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-2-sample-size-calculation">Example 2: Sample Size Calculation<a class="anchor" aria-label="anchor" href="#example-2-sample-size-calculation"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate required sample size using Boschloo's test</span></span>
<span><span class="va">result_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryExact.html">ss2BinaryExact</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.70</span>, p12 <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.50</span>, p22 <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"Boschloo"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_ss</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 120</span></span>
<span><span class="co">#&gt;              n2 = 120</span></span>
<span><span class="co">#&gt;               N = 240</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.65</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.5, 0.45</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = Boschloo</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-comparison-of-test-methods">Example 3: Comparison of Test Methods<a class="anchor" aria-label="anchor" href="#example-3-comparison-of-test-methods"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different exact test methods</span></span>
<span><span class="va">test_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chisq"</span>, <span class="st">"Fisher"</span>, <span class="st">"Fisher-midP"</span>, <span class="st">"Z-pool"</span>, <span class="st">"Boschloo"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">test_methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryExact.html">ss2BinaryExact</a></span><span class="op">(</span></span>
<span>        p11 <span class="op">=</span> <span class="fl">0.50</span>, p12 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>        p21 <span class="op">=</span> <span class="fl">0.20</span>, p22 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>        rho1 <span class="op">=</span> <span class="fl">0.7</span>, rho2 <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>        beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        Test <span class="op">=</span> <span class="va">test</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        Test <span class="op">=</span> <span class="va">test</span>,</span>
<span>        n2 <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>        N <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">N</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison_table</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Sample Size Comparison Across Test Methods"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Test Method"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sample Size Comparison Across Test Methods</caption>
<thead><tr class="header">
<th align="left">Test Method</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Chisq</td>
<td align="right">42</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="left">Fisher</td>
<td align="right">49</td>
<td align="right">98</td>
</tr>
<tr class="odd">
<td align="left">Fisher-midP</td>
<td align="right">43</td>
<td align="right">86</td>
</tr>
<tr class="even">
<td align="left">Z-pool</td>
<td align="right">43</td>
<td align="right">86</td>
</tr>
<tr class="odd">
<td align="left">Boschloo</td>
<td align="right">43</td>
<td align="right">86</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="impact-of-correlation">Impact of Correlation<a class="anchor" aria-label="anchor" href="#impact-of-correlation"></a>
</h2>
<div class="section level3">
<h3 id="example-4-correlation-effect">Example 4: Correlation Effect<a class="anchor" aria-label="anchor" href="#example-4-correlation-effect"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate sample size for different correlation values</span></span>
<span><span class="va">rho_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">correlation_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryExact.html">ss2BinaryExact</a></span><span class="op">(</span></span>
<span>        p11 <span class="op">=</span> <span class="fl">0.70</span>, p12 <span class="op">=</span> <span class="fl">0.60</span>,</span>
<span>        p21 <span class="op">=</span> <span class="fl">0.40</span>, p22 <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>        rho1 <span class="op">=</span> <span class="va">rho</span>, rho2 <span class="op">=</span> <span class="va">rho</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>        beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        Test <span class="op">=</span> <span class="st">"Fisher"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        rho <span class="op">=</span> <span class="va">rho</span>,</span>
<span>        n2 <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>        N <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">N</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rho_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">correlation_effect</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">rho_table</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Impact of Correlation on Sample Size (Fisher's Test)"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ρ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Impact of Correlation on Sample Size (Fisher’s Test)</caption>
<thead><tr class="header">
<th align="right">ρ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">61</td>
<td align="right">122</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">60</td>
<td align="right">120</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">59</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">56</td>
<td align="right">112</td>
</tr>
</tbody>
</table>
<p><strong>Key finding</strong>: Higher positive correlation reduces
required sample size.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-exact-vs-asymptotic">Comparison: Exact vs Asymptotic<a class="anchor" aria-label="anchor" href="#comparison-exact-vs-asymptotic"></a>
</h2>
<div class="section level3">
<h3 id="example-5-exact-vs-an-method">Example 5: Exact vs AN Method<a class="anchor" aria-label="anchor" href="#example-5-exact-vs-an-method"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exact method (Chisq)</span></span>
<span><span class="va">exact_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryExact.html">ss2BinaryExact</a></span><span class="op">(</span></span>
<span>    p11 <span class="op">=</span> <span class="fl">0.60</span>, p12 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>    p21 <span class="op">=</span> <span class="fl">0.30</span>, p22 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    Test <span class="op">=</span> <span class="st">"Chisq"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Asymptotic method (AN)</span></span>
<span><span class="va">asymp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>    p11 <span class="op">=</span> <span class="fl">0.60</span>, p12 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>    p21 <span class="op">=</span> <span class="fl">0.30</span>, p22 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_exact_asymp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exact (Chisq)"</span>, <span class="st">"Asymptotic (AN)"</span><span class="op">)</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">n2</span>, <span class="va">asymp_result</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span>,</span>
<span>  N_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">N</span>, <span class="va">asymp_result</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>,</span>
<span>  Difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">asymp_result</span><span class="op">$</span><span class="va">N</span> <span class="op">-</span> <span class="va">exact_result</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison_exact_asymp</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison: Exact vs Asymptotic Methods"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Method"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span>, <span class="st">"Difference"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison: Exact vs Asymptotic Methods</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">n per group</th>
<th align="right">N total</th>
<th align="right">Difference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Exact (Chisq)</td>
<td align="right">59</td>
<td align="right">118</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Asymptotic (AN)</td>
<td align="right">60</td>
<td align="right">120</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="test-method-selection">Test Method Selection<a class="anchor" aria-label="anchor" href="#test-method-selection"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Fisher’s exact test</strong>:
<ul>
<li>Most widely used and accepted</li>
<li>Conservative but guarantees Type I error control</li>
<li>Recommended for regulatory submissions</li>
</ul>
</li>
<li>
<strong>Boschloo’s test</strong>:
<ul>
<li>Most powerful among exact tests</li>
<li>Best choice when computational resources permit</li>
<li>Recommended for final analysis</li>
</ul>
</li>
<li>
<strong>Chi-squared test</strong>:
<ul>
<li>Less conservative than Fisher</li>
<li>May be anti-conservative for small samples</li>
<li>Use with caution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &lt; 200</annotation></semantics></math>
</li>
</ul>
</li>
<li>
<strong>Z-pooled and Fisher-midP</strong>:
<ul>
<li>Intermediate between Fisher and chi-squared</li>
<li>Reduce conservatism while maintaining validity</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-each-method">When to Use Each Method<a class="anchor" aria-label="anchor" href="#when-to-use-each-method"></a>
</h3>
<p><strong>Sample size guidelines</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N &lt; 100</annotation></semantics></math></strong>:
Always use exact methods</p></li>
<li>
<p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>≤</mo><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">100 \leq N &lt; 200</annotation></semantics></math></strong>:
Exact methods preferred, especially if:</p>
<ul>
<li>Extreme probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">p &gt; 0.9</annotation></semantics></math>)</li>
<li>Strict Type I error control required</li>
</ul>
</li>
<li><p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>≥</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N \geq 200</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.1</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">0.1 &lt; p &lt; 0.9</annotation></semantics></math></strong>:
Asymptotic methods acceptable</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="correlation-estimation">Correlation Estimation<a class="anchor" aria-label="anchor" href="#correlation-estimation"></a>
</h3>
<ul>
<li>Use pilot data or historical information</li>
<li>Be conservative if uncertain (use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>)</li>
<li>Consider sensitivity analysis across plausible range</li>
</ul>
</div>
<div class="section level3">
<h3 id="allocation-ratio">Allocation Ratio<a class="anchor" aria-label="anchor" href="#allocation-ratio"></a>
</h3>
<ul>
<li>Balanced design
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>)
generally most efficient</li>
<li>Unbalanced designs may be justified by:
<ul>
<li>Limited control group availability</li>
<li>Ethical considerations</li>
<li>Cost constraints</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="computational-considerations">Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a>
</h2>
<p>Modern computers handle all methods efficiently for typical clinical
trial sample sizes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>300</mn></mrow><annotation encoding="application/x-tex">N &lt; 300</annotation></semantics></math>).</p>
<div class="section level3">
<h3 id="software-implementation">Software Implementation<a class="anchor" aria-label="anchor" href="#software-implementation"></a>
</h3>
<p>The <code>twoCoprimary</code> package implements all methods
efficiently using:</p>
<ul>
<li>Bivariate binomial distribution (<code>dbibinom</code>)</li>
<li>Rejection region calculation (<code>rr1Binary</code>)</li>
<li>Vectorized computations for speed</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Homma, G., &amp; Yoshida, T. (2025). Exact power and sample size in
clinical trials with two co-primary binary endpoints. <em>Statistical
Methods in Medical Research</em>, 34(1), 1-19.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  
</body>
</html>
