<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mixed Count and Continuous Co-Primary Endpoints • twoCoprimary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mixed Count and Continuous Co-Primary Endpoints">
</head>
<body>
<p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mixed Count and Continuous Co-Primary Endpoints</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/vignettes/mixed-count-continuous.Rmd" class="external-link"><code>vignettes/mixed-count-continuous.Rmd</code></a></small>
      <div class="d-none name"><code>mixed-count-continuous.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates sample size calculation and power analysis
for clinical trials with two co-primary endpoints: an overdispersed
count outcome (following negative binomial distribution) and a
continuous outcome (following normal distribution). The methodology is
based on Homma and Yoshida (2024).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaex.github.io/twoCoprimary/" class="external-link">twoCoprimary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="clinical-context">Clinical Context<a class="anchor" aria-label="anchor" href="#clinical-context"></a>
</h3>
<p>In clinical trials for treating <strong>asthma</strong> and
<strong>chronic obstructive pulmonary disease (COPD)</strong>,
regulatory agencies require evaluation of both:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Count endpoint</strong>: Number of exacerbations over
follow-up period (overdispersed count data)</li>
<li>
<strong>Continuous endpoint</strong>: Lung function measure such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">FEV</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{FEV}_{1}</annotation></semantics></math>
(forced expiratory volume in 1 second)</li>
</ol>
</div>
<div class="section level3">
<h3 id="why-negative-binomial-distribution">Why Negative Binomial Distribution?<a class="anchor" aria-label="anchor" href="#why-negative-binomial-distribution"></a>
</h3>
<p>Count outcomes in clinical trials often exhibit
<strong>overdispersion</strong>, where the variance substantially
exceeds the mean. The Poisson distribution assumes variance = mean,
which is often violated.</p>
<p><strong>Negative binomial (NB) distribution</strong> accommodates
overdispersion:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>,</mo><mi>ν</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \sim \text{NB}(\lambda, \nu)</annotation></semantics></math></p>
<ul>
<li>
<strong>Mean</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">E</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>λ</mi><mo>=</mo><mi>r</mi><mo>×</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">\text{E}[X] = \lambda = r \times t</annotation></semantics></math>
(rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
time)</li>
<li>
<strong>Variance</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>λ</mi><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mi>/</mi><mi>ν</mi></mrow><annotation encoding="application/x-tex">\text{Var}[X] = \lambda + \lambda^{2}/\nu</annotation></semantics></math>
</li>
<li>
<strong>Dispersion parameter</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nu &gt; 0</annotation></semantics></math>
controls overdispersion
<ul>
<li>As
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">\nu \to \infty</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">NB</mtext><mo>→</mo><mtext mathvariant="normal">Poisson</mtext></mrow><annotation encoding="application/x-tex">\text{NB} \to \text{Poisson}</annotation></semantics></math>
(no overdispersion)</li>
<li>Small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>:
High overdispersion (variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≫</mo><annotation encoding="application/x-tex">\gg</annotation></semantics></math>
mean)</li>
</ul>
</li>
</ul>
<p><strong>Variance-to-mean ratio (VMR)</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">VMR</mtext><mo>=</mo><mfrac><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mtext mathvariant="normal">E</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mi>λ</mi><mi>ν</mi></mfrac></mrow><annotation encoding="application/x-tex">\text{VMR} = \frac{\text{Var}[X]}{\text{E}[X]} = 1 + \frac{\lambda}{\nu}</annotation></semantics></math></p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">VMR</mtext><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{VMR} &gt; 1</annotation></semantics></math>,
data are overdispersed and NB is more appropriate than Poisson.</p>
</div>
</div>
<div class="section level2">
<h2 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h2>
<div class="section level3">
<h3 id="model-and-assumptions">Model and Assumptions<a class="anchor" aria-label="anchor" href="#model-and-assumptions"></a>
</h3>
<p>Consider a two-arm superiority trial with sample sizes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_{1}</annotation></semantics></math>
(treatment) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
(control), with allocation ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r = n_{1}/n_{2}</annotation></semantics></math>.</p>
<p>For subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j = 1</annotation></semantics></math>:
treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">j = 2</annotation></semantics></math>:
control), we observe two <strong>outcomes</strong>:</p>
<p><strong>Outcome 1 (Count)</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>∼</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mi>j</mi></msub><mo>,</mo><mi>ν</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{i,j,1} \sim \text{NB}(\lambda_{j}, \nu)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\lambda_{j}</annotation></semantics></math>
is the expected number of events in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nu &gt; 0</annotation></semantics></math>
is the common dispersion parameter.</p>
<p><strong>Outcome 2 (Continuous)</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>j</mi></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{i,j,2} \sim \text{N}(\mu_{j}, \sigma^{2})</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_{j}</annotation></semantics></math>
is the population mean in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^{2}</annotation></semantics></math>
is the common variance across groups.</p>
</div>
<div class="section level3">
<h3 id="correlation-structure">Correlation Structure<a class="anchor" aria-label="anchor" href="#correlation-structure"></a>
</h3>
<p>The correlation between count and continuous outcomes within subjects
is measured by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
This correlation must satisfy <strong>feasibility constraints</strong>
based on the Fréchet-Hoeffding copula bounds, which depend on the
marginal distributions.</p>
<p>Use the <code><a href="../reference/corrbound2MixedCountContinuous.html">corrbound2MixedCountContinuous()</a></code> function to
check valid correlation bounds for given parameters.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>We test superiority of treatment over control for both endpoints.
<strong>Note</strong>: In COPD/asthma trials, treatment benefit is
indicated by <strong>lower values</strong> for both endpoints (fewer
exacerbations, less decline in lung function).</p>
<p><strong>For count endpoint</strong> (1):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>:</mo><msub><mi>r</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>r</mi><mn>2</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>:</mo><msub><mi>r</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_{01}: r_{1} \geq r_{2} \text{ vs. } \text{H}_{11}: r_{1} &lt; r_{2}</annotation></semantics></math></p>
<p>Equivalently, testing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{1} = \log(r_{1}) - \log(r_{2}) &lt; 0</annotation></semantics></math>.</p>
<p><strong>For continuous endpoint</strong> (2):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub><mo>:</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{H}_{02}: \mu_{1} - \mu_{2} \geq 0 \text{ vs. } \text{H}_{12}: \mu_{1} - \mu_{2} &lt; 0</annotation></semantics></math></p>
<p><strong>Co-primary endpoints</strong> (intersection-union test):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>∪</mo><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>∩</mo><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_0 = \text{H}_{01} \cup \text{H}_{02} \text{ vs. } \text{H}_1 = \text{H}_{11} \cap \text{H}_{12}</annotation></semantics></math></p>
<p>Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
if and only if <strong>both</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><annotation encoding="application/x-tex">\text{H}_{01}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><annotation encoding="application/x-tex">\text{H}_{02}</annotation></semantics></math>
are rejected at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h3>
<p><strong>Count endpoint</strong> (Equation 7 in Homma and Yoshida,
2024):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mfrac><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><msqrt><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Z_{1} = \frac{\hat{\beta}_{1}}{\sqrt{\text{Var}(\hat{\beta}_{1})}}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\beta}_{1} = \log(\bar{X}_{1,1}) - \log(\bar{X}_{2,1})</annotation></semantics></math>
is the log rate ratio</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mi>t</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>λ</mi><mn>2</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mi>r</mi><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow><mrow><mi>ν</mi><mi>r</mi></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><msub><mi>V</mi><mi>a</mi></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\text{Var}(\hat{\beta}_{1}) = \frac{1}{n_{2}}\left[\frac{1}{t}\left(\frac{1}{\lambda_{2}} + \frac{1}{r\lambda_{1}}\right) + \frac{1+r}{\nu r}\right] = \frac{V_{a}}{n_{2}}</annotation></semantics></math></li>
</ul>
<p><strong>Continuous endpoint</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>−</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mrow><mrow><mi>σ</mi><msqrt><mfrac><mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow><mrow><mi>r</mi><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_{2} = \frac{\bar{X}_{1,2} - \bar{X}_{2,2}}{\sigma\sqrt{\frac{1+r}{r n_{2}}}}</annotation></semantics></math></p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is a common known standard deviation.</p>
</div>
<div class="section level3">
<h3 id="joint-distribution-and-correlation">Joint Distribution and Correlation<a class="anchor" aria-label="anchor" href="#joint-distribution-and-correlation"></a>
</h3>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{H}_{1}</annotation></semantics></math>,
the test statistics
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_{1}, Z_{2})</annotation></semantics></math>
asymptotically follow a bivariate normal distribution (Appendix B in
Homma and Yoshida, 2024):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Z</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Z</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">BN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ω</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ω</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>γ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>γ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{pmatrix} Z_1 \\ Z_2 \end{pmatrix} \sim \text{BN}\left(\begin{pmatrix} \omega_1 \\ \omega_2 \end{pmatrix}, \begin{pmatrix} 1 &amp; \gamma \\ \gamma &amp; 1 \end{pmatrix}\right)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><msqrt><msub><mi>n</mi><mn>2</mn></msub></msqrt><msub><mi>β</mi><mn>1</mn></msub></mrow><msqrt><msub><mi>V</mi><mi>a</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\omega_{1} = \frac{\sqrt{n_{2}}\beta_{1}}{\sqrt{V_{a}}}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_{1} = \log(r_{1}) - \log(r_{2})</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mn>2</mn></msub><mo>=</mo><mfrac><mi>δ</mi><mrow><mi>σ</mi><msqrt><mfrac><mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow><mrow><mi>r</mi><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">\omega_{2} = \frac{\delta}{\sigma\sqrt{\frac{1+r}{r n_{2}}}}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\delta = \mu_{1} - \mu_{2}</annotation></semantics></math>
</li>
</ul>
<p><strong>Correlation between test statistics</strong> (Equation 11 in
Homma and Yoshida, 2024):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mfrac><mrow><msub><mi>n</mi><mn>2</mn></msub><msub><mi>ρ</mi><mi>j</mi></msub><msqrt><mrow><mn>1</mn><mo>+</mo><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><mi>ν</mi></mrow></msqrt></mrow><mrow><msub><mi>n</mi><mi>j</mi></msub><msqrt><mrow><msub><mi>λ</mi><mi>j</mi></msub><msub><mi>V</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>r</mi></mrow></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">\gamma = \sum_{j=1}^{2} \frac{n_{2}\rho_{j}\sqrt{1+\lambda_{j}/\nu}}{n_{j}\sqrt{\lambda_{j}V_{a}(1+r)/r}}</annotation></semantics></math></p>
<p>For <strong>balanced design</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>)
with <strong>common correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>1</mn></msub><mo>=</mo><msub><mi>ρ</mi><mn>2</mn></msub><mo>=</mo><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho_{1} = \rho_{2} = \rho</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mfrac><mi>ρ</mi><msqrt><mn>2</mn></msqrt></mfrac><mfrac><mrow><msqrt><mrow><mn>1</mn><mi>/</mi><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mi>/</mi><mi>ν</mi></mrow></msqrt><mo>+</mo><msqrt><mrow><mn>1</mn><mi>/</mi><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mi>/</mi><mi>ν</mi></mrow></msqrt></mrow><msqrt><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mi>/</mi><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><mi>/</mi><mi>ν</mi><mo stretchy="true" form="postfix">)</mo></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\gamma = \frac{\rho}{\sqrt{2}}\frac{\sqrt{1/\lambda_{2} + 1/\nu} + \sqrt{1/\lambda_{1} + 1/\nu}}{\sqrt{(1/\lambda_{2} + 1/\lambda_{1} + 2/\nu)}}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="power-calculation">Power Calculation<a class="anchor" aria-label="anchor" href="#power-calculation"></a>
</h3>
<p>The overall power is (Equation 10 in Homma and Yoshida, 2024):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>z</mi><mi>α</mi></msub><mo>∩</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>z</mi><mi>α</mi></msub><mo>∣</mo><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \text{P}(Z_{1} &lt; z_{\alpha} \cap Z_{2} &lt; z_{\alpha} \mid \text{H}_{1})</annotation></semantics></math></p>
<p>Using the bivariate normal CDF
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\Phi_{2}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><msub><mi>Φ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>α</mi></msub><mo>−</mo><mfrac><mrow><msqrt><msub><mi>n</mi><mn>2</mn></msub></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>r</mi><mn>1</mn></msub><mo>−</mo><mo>log</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><msub><mi>V</mi><mi>a</mi></msub></msqrt></mfrac><mo>,</mo><msub><mi>z</mi><mi>α</mi></msub><mo>−</mo><mfrac><mrow><msqrt><msub><mi>n</mi><mn>2</mn></msub></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>σ</mi><msqrt><mfrac><mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow><mi>r</mi></mfrac></msqrt></mrow></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">|</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \Phi_{2}\left(z_{\alpha} - \frac{\sqrt{n_{2}}(\log r_{1} - \log r_{2})}{\sqrt{V_{a}}}, z_{\alpha} - \frac{\sqrt{n_{2}}(\mu_{1}-\mu_{2})}{\sigma\sqrt{\frac{1+r}{r}}} \Bigg| \gamma\right)</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="sample-size-determination">Sample Size Determination<a class="anchor" aria-label="anchor" href="#sample-size-determination"></a>
</h3>
<p>The sample size is determined by solving the power equation
numerically. For a given allocation ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
target power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>,
and significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
we find the smallest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
such that the overall power equals or exceeds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>.</p>
<p><strong>Sequential search algorithm</strong>:</p>
<ol style="list-style-type: decimal">
<li>Calculate initial sample size based on single-endpoint formulas</li>
<li>Compute power at current sample size</li>
<li>If power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
target: decrease
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
until power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
target, then add 1 back</li>
<li>If power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
target: increase
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
until power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
target</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="correlation-bounds">Correlation Bounds<a class="anchor" aria-label="anchor" href="#correlation-bounds"></a>
</h2>
<div class="section level3">
<h3 id="example-calculate-correlation-bounds">Example: Calculate Correlation Bounds<a class="anchor" aria-label="anchor" href="#example-calculate-correlation-bounds"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scenario: lambda = 1.25, nu = 0.8, mu = 0, sigma = 250</span></span>
<span><span class="va">bounds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrbound2MixedCountContinuous.html">corrbound2MixedCountContinuous</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1.25</span>, nu <span class="op">=</span> <span class="fl">0.8</span>, mu <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation bounds for NB(1.25, 0.8) and N(0, 250²):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation bounds for NB(1.25, 0.8) and N(0, 250²):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Lower bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lower bound: -0.846</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Upper bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Upper bound: 0.846</span></span>
<span></span>
<span><span class="co"># Higher dispersion (smaller nu) typically restricts bounds</span></span>
<span><span class="va">bounds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrbound2MixedCountContinuous.html">corrbound2MixedCountContinuous</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1.25</span>, nu <span class="op">=</span> <span class="fl">0.5</span>, mu <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation bounds for NB(1.25, 0.5) and N(0, 250²):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation bounds for NB(1.25, 0.5) and N(0, 250²):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Lower bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lower bound: -0.802</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Upper bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Upper bound: 0.802</span></span>
<span></span>
<span><span class="co"># Higher mean count</span></span>
<span><span class="va">bounds3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corrbound2MixedCountContinuous.html">corrbound2MixedCountContinuous</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.0</span>, nu <span class="op">=</span> <span class="fl">0.8</span>, mu <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation bounds for NB(2.0, 0.8) and N(0, 250²):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation bounds for NB(2.0, 0.8) and N(0, 250²):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Lower bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lower bound: -0.863</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Upper bound:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bounds3</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Upper bound: 0.863</span></span></code></pre></div>
<p><strong>Important</strong>: Always verify that the specified
correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is within the feasible bounds for your parameters.</p>
</div>
</div>
<div class="section level2">
<h2 id="replicating-homma-and-yoshida-2024-table-1-case-b">Replicating Homma and Yoshida (2024) Table 1 (Case B)<a class="anchor" aria-label="anchor" href="#replicating-homma-and-yoshida-2024-table-1-case-b"></a>
</h2>
<p>Table 1 from Homma and Yoshida (2024) shows sample sizes and
operating characteristics for various scenarios. We replicate
<strong>Case B</strong> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\nu = 3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\nu = 5</annotation></semantics></math>.</p>
<p><strong>Design parameters for Case B</strong>:</p>
<ul>
<li>Count rates:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{2} = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">r_{1} = 2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t = 1</annotation></semantics></math>
→
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_{2} = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\lambda_{1} = 2</annotation></semantics></math>
</li>
<li>Dispersion:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\nu = 3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn><annotation encoding="application/x-tex">5</annotation></semantics></math>
</li>
<li>Continuous means:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_{2} = 0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\mu_{1} = -50</annotation></semantics></math>
(negative indicates less decline)</li>
<li>Standard deviation:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>75</mn></mrow><annotation encoding="application/x-tex">\sigma = 75</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.025</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.025</annotation></semantics></math>
(one-sided),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">1 - \beta = 0.9</annotation></semantics></math>
(target power)</li>
<li>Balanced allocation:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_{1} = n_{2}</annotation></semantics></math>)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define scenarios for Table 1 Case B</span></span>
<span><span class="va">scenarios_table1_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate sample sizes for each scenario</span></span>
<span><span class="va">results_table1_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">scenarios_table1_B</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nu_val</span> <span class="op">&lt;-</span> <span class="va">scenarios_table1_B</span><span class="op">$</span><span class="va">nu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">rho_val</span> <span class="op">&lt;-</span> <span class="va">scenarios_table1_B</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>    r1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    r2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    nu <span class="op">=</span> <span class="va">nu_val</span>,</span>
<span>    t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>,</span>
<span>    mu2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">75</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="va">rho_val</span>,</span>
<span>    rho2 <span class="op">=</span> <span class="va">rho_val</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    nu <span class="op">=</span> <span class="va">nu_val</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho_val</span>,</span>
<span>    n2 <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>    n1 <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>    N <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">N</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table1_B_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">results_table1_B</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results grouped by nu</span></span>
<span><span class="va">table1_B_nu3</span> <span class="op">&lt;-</span> <span class="va">table1_B_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nu</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">n2</span>, <span class="va">N</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table1_B_nu5</span> <span class="op">&lt;-</span> <span class="va">table1_B_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nu</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">n2</span>, <span class="va">N</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table1_B_nu3</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Table 1 Case B: Sample Sizes (ν = 3, Balanced Design, α = 0.025, 1-β = 0.9)"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ρ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 1 Case B: Sample Sizes (ν = 3, Balanced Design, α =
0.025, 1-β = 0.9)</caption>
<thead><tr class="header">
<th align="right">ρ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">59</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">58</td>
<td align="right">116</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">57</td>
<td align="right">114</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">56</td>
<td align="right">112</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">54</td>
<td align="right">108</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table1_B_nu5</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Table 1 Case B: Sample Sizes (ν = 5, Balanced Design, α = 0.025, 1-β = 0.9)"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ρ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table 1 Case B: Sample Sizes (ν = 5, Balanced Design, α =
0.025, 1-β = 0.9)</caption>
<thead><tr class="header">
<th align="right">ρ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">55</td>
<td align="right">110</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">55</td>
<td align="right">110</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">54</td>
<td align="right">108</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">53</td>
<td align="right">106</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">51</td>
<td align="right">102</td>
</tr>
</tbody>
</table>
<p><strong>Observations</strong>:</p>
<ul>
<li>Higher dispersion parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
(less overdispersion) requires <strong>smaller</strong> sample
sizes</li>
<li>Correlation reduces sample size: approximately 2-4% at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\rho = 0.4</annotation></semantics></math>,
5-8% at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>
</li>
<li>The effect of correlation is moderate compared to other endpoint
combinations</li>
</ul>
</div>
<div class="section level2">
<h2 id="basic-usage-examples">Basic Usage Examples<a class="anchor" aria-label="anchor" href="#basic-usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-balanced-design">Example 1: Balanced Design<a class="anchor" aria-label="anchor" href="#example-1-balanced-design"></a>
</h3>
<p>Calculate sample size for a balanced design with moderate effect
sizes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Balanced design: n1 = n2 (i.e., r = 1)</span></span>
<span><span class="va">result_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>  r1 <span class="op">=</span> <span class="fl">1.0</span>,              <span class="co"># Count rate in treatment group</span></span>
<span>  r2 <span class="op">=</span> <span class="fl">1.25</span>,             <span class="co"># Count rate in control group</span></span>
<span>  nu <span class="op">=</span> <span class="fl">0.8</span>,              <span class="co"># Dispersion parameter</span></span>
<span>  t <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Follow-up time</span></span>
<span>  mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>,             <span class="co"># Mean for treatment (negative = benefit)</span></span>
<span>  mu2 <span class="op">=</span> <span class="fl">0</span>,               <span class="co"># Mean for control</span></span>
<span>  sd <span class="op">=</span> <span class="fl">250</span>,              <span class="co"># Standard deviation</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Balanced allocation</span></span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in treatment group</span></span>
<span>  rho2 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in control group</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for mixed count and continuous co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 705</span></span>
<span><span class="co">#&gt;              n2 = 705</span></span>
<span><span class="co">#&gt;               N = 1410</span></span>
<span><span class="co">#&gt;              sd = 250</span></span>
<span><span class="co">#&gt;            rate = 1, 1.25</span></span>
<span><span class="co">#&gt;              nu = 0.8</span></span>
<span><span class="co">#&gt;               t = 1</span></span>
<span><span class="co">#&gt;              mu = -50, 0</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-effect-of-correlation">Example 2: Effect of Correlation<a class="anchor" aria-label="anchor" href="#example-2-effect-of-correlation"></a>
</h3>
<p>Demonstrate how correlation affects sample size:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed effect sizes</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fl">1.25</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">50</span></span>
<span><span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span></span>
<span><span class="co"># Range of correlations</span></span>
<span><span class="va">rho_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_by_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>    r1 <span class="op">=</span> <span class="va">r1</span>, r2 <span class="op">=</span> <span class="va">r2</span>, nu <span class="op">=</span> <span class="va">nu</span>, t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    mu1 <span class="op">=</span> <span class="va">mu1</span>, mu2 <span class="op">=</span> <span class="va">mu2</span>, sd <span class="op">=</span> <span class="va">sd</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="va">rho</span>, rho2 <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">result</span><span class="op">$</span><span class="va">n2</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rho <span class="op">=</span> <span class="va">rho_values</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="va">ss_by_rho</span>,</span>
<span>  N_total <span class="op">=</span> <span class="va">ss_by_rho</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>  reduction_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ss_by_rho</span> <span class="op">/</span> <span class="va">ss_by_rho</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_df</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Effect of Correlation on Sample Size"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ρ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span>, <span class="st">"Reduction (%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Effect of Correlation on Sample Size</caption>
<thead><tr class="header">
<th align="right">ρ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
<th align="right">Reduction (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">727</td>
<td align="right">1454</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">720</td>
<td align="right">1440</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">711</td>
<td align="right">1422</td>
<td align="right">2.2</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">699</td>
<td align="right">1398</td>
<td align="right">3.9</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">685</td>
<td align="right">1370</td>
<td align="right">5.8</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="va">ss_by_rho</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Correlation (ρ)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Sample size per group (n)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Effect of Correlation on Sample Size"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ss_by_rho</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="mixed-count-continuous_files/figure-html/example2-1.png" class="r-plt" width="672"></p>
<p><strong>Interpretation</strong>: Higher positive correlation reduces
required sample size. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>,
sample size is reduced by approximately 5-7% compared to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="example-3-effect-of-dispersion-parameter">Example 3: Effect of Dispersion Parameter<a class="anchor" aria-label="anchor" href="#example-3-effect-of-dispersion-parameter"></a>
</h3>
<p>Compare sample sizes for different levels of overdispersion:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed design parameters</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fl">1.25</span></span>
<span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">50</span></span>
<span><span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Range of dispersion parameters</span></span>
<span><span class="va">nu_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">5.0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_by_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nu_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nu</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>    r1 <span class="op">=</span> <span class="va">r1</span>, r2 <span class="op">=</span> <span class="va">r2</span>, nu <span class="op">=</span> <span class="va">nu</span>, t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    mu1 <span class="op">=</span> <span class="va">mu1</span>, mu2 <span class="op">=</span> <span class="va">mu2</span>, sd <span class="op">=</span> <span class="va">sd</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="va">rho</span>, rho2 <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">result</span><span class="op">$</span><span class="va">n2</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_df_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  nu <span class="op">=</span> <span class="va">nu_values</span>,</span>
<span>  VMR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.125</span><span class="op">/</span><span class="va">nu_values</span>, <span class="fl">2</span><span class="op">)</span>,  <span class="co"># VMR at lambda = 1.125 (average)</span></span>
<span>  n_per_group <span class="op">=</span> <span class="va">ss_by_nu</span>,</span>
<span>  N_total <span class="op">=</span> <span class="va">ss_by_nu</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_df_nu</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Effect of Dispersion Parameter on Sample Size"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ν"</span>, <span class="st">"VMR"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Effect of Dispersion Parameter on Sample Size</caption>
<thead><tr class="header">
<th align="right">ν</th>
<th align="right">VMR</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">3.25</td>
<td align="right">921</td>
<td align="right">1842</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">2.41</td>
<td align="right">705</td>
<td align="right">1410</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">2.12</td>
<td align="right">639</td>
<td align="right">1278</td>
</tr>
<tr class="even">
<td align="right">2.0</td>
<td align="right">1.56</td>
<td align="right">522</td>
<td align="right">1044</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">1.23</td>
<td align="right">463</td>
<td align="right">926</td>
</tr>
</tbody>
</table>
<p><strong>Key finding</strong>: Higher overdispersion (smaller
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>,
larger VMR) requires larger sample sizes.</p>
</div>
<div class="section level3">
<h3 id="example-4-unbalanced-allocation">Example 4: Unbalanced Allocation<a class="anchor" aria-label="anchor" href="#example-4-unbalanced-allocation"></a>
</h3>
<p>Calculate sample size with 2:1 allocation ratio:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Balanced design (r = 1)</span></span>
<span><span class="va">result_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>  r1 <span class="op">=</span> <span class="fl">1.0</span>, r2 <span class="op">=</span> <span class="fl">1.25</span>, nu <span class="op">=</span> <span class="fl">0.8</span>, t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, mu2 <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unbalanced design (r = 2, i.e., n1 = 2*n2)</span></span>
<span><span class="va">result_unbalanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>  r1 <span class="op">=</span> <span class="fl">1.0</span>, r2 <span class="op">=</span> <span class="fl">1.25</span>, nu <span class="op">=</span> <span class="fl">0.8</span>, t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, mu2 <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_allocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Balanced (1:1)"</span>, <span class="st">"Unbalanced (2:1)"</span><span class="op">)</span>,</span>
<span>  n_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">n1</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">n1</span><span class="op">)</span>,</span>
<span>  n_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">n2</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span>,</span>
<span>  N_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span>, <span class="va">result_unbalanced</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison_allocation</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison: Balanced vs Unbalanced Allocation"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Design"</span>, <span class="st">"n₁"</span>, <span class="st">"n₂"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison: Balanced vs Unbalanced Allocation</caption>
<thead><tr class="header">
<th align="left">Design</th>
<th align="right">n₁</th>
<th align="right">n₂</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Balanced (1:1)</td>
<td align="right">705</td>
<td align="right">705</td>
<td align="right">1410</td>
</tr>
<tr class="even">
<td align="left">Unbalanced (2:1)</td>
<td align="right">1044</td>
<td align="right">522</td>
<td align="right">1566</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nIncrease in total sample size:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">result_unbalanced</span><span class="op">$</span><span class="va">N</span> <span class="op">-</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span><span class="op">)</span> <span class="op">/</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">N</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Increase in total sample size: 11.1 %</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-verification">Power Verification<a class="anchor" aria-label="anchor" href="#power-verification"></a>
</h2>
<p>Verify that calculated sample sizes achieve target power:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use result from Example 1</span></span>
<span><span class="va">power_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power2MixedCountContinuous.html">power2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>  n1 <span class="op">=</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>  n2 <span class="op">=</span> <span class="va">result_balanced</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>  r1 <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  r2 <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>  nu <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>,</span>
<span>  mu2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target power: 0.80\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target power: 0.80</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Count endpoint):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Count endpoint):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Continuous endpoint):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power2</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Continuous endpoint):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Co-primary):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">powerCoprimary</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Co-primary): 0.8003</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="design-considerations">Design Considerations<a class="anchor" aria-label="anchor" href="#design-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Estimating dispersion parameter</strong>: Use pilot data
or historical studies to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>.
Underestimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
(overestimating overdispersion) leads to conservative sample
sizes.</p></li>
<li><p><strong>Estimating correlation</strong>: Use pilot data; be
conservative if uncertain
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>
is conservative).</p></li>
<li><p><strong>Direction of benefit</strong>: For COPD/asthma trials,
ensure test directions are correct (lower is better for both
endpoints).</p></li>
<li><p><strong>Balanced allocation</strong>: Generally most efficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r = 1</annotation></semantics></math>)
unless practical constraints require otherwise.</p></li>
<li><p><strong>Sensitivity analysis</strong>: Calculate sample sizes for
range of plausible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
and effect sizes.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-this-method">When to Use This Method<a class="anchor" aria-label="anchor" href="#when-to-use-this-method"></a>
</h3>
<p>Use mixed count-continuous methods when:</p>
<ul>
<li>One endpoint is an overdispersed count (exacerbations, events)</li>
<li>Other endpoint is continuous (lung function, quality of life)</li>
<li>Both endpoints are clinically meaningful co-primary endpoints</li>
<li>Negative binomial distribution is appropriate for count data</li>
</ul>
</div>
<div class="section level3">
<h3 id="challenges-and-considerations">Challenges and Considerations<a class="anchor" aria-label="anchor" href="#challenges-and-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Overdispersion estimation</strong>: Requires historical
data or pilot studies; misspecification affects sample size</p></li>
<li><p><strong>Correlation estimation</strong>: Correlation between
count and continuous outcomes is challenging to estimate</p></li>
<li><p><strong>Direction specification</strong>: Ensure treatment
benefit direction is correctly specified for both endpoints</p></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Homma, G., &amp; Yoshida, T. (2024). Sample size calculation in
clinical trials with two co-primary endpoints including overdispersed
count and continuous outcomes. <em>Pharmaceutical Statistics</em>,
23(1), 46-59.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  
</body>
</html>
