<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Two Binary Co-Primary Endpoints (Asymptotic Methods) • twoCoprimary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two Binary Co-Primary Endpoints (Asymptotic Methods)">
</head>
<body>
<p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Two Binary Co-Primary Endpoints (Asymptotic Methods)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/vignettes/two-binary-endpoints-approx.Rmd" class="external-link"><code>vignettes/two-binary-endpoints-approx.Rmd</code></a></small>
      <div class="d-none name"><code>two-binary-endpoints-approx.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates sample size calculation for clinical
trials with two co-primary binary endpoints using asymptotic normal
approximation methods. The methodology is based on Sozu et
al. (2010).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaex.github.io/twoCoprimary/" class="external-link">twoCoprimary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="clinical-context">Clinical Context<a class="anchor" aria-label="anchor" href="#clinical-context"></a>
</h3>
<p>Binary co-primary endpoints are common in:</p>
<ul>
<li><p><strong>Migraine trials</strong>: Relief from headache (yes/no) +
Relief from the most bothersome migraine-related symptom
(yes/no)</p></li>
<li><p><strong>Psoriasis trials</strong>: At least 75% improvement in
the score on the psoriasis area-and-severity index (PASI) (yes/no) +
Score on the physician’s global assessment of 0 or 1 (yes/no)</p></li>
<li><p><strong>Primary myelofibrosis trials</strong>: Clinically
relevant complete haematological response (yes/no) + Lack of progression
of clinical symptoms (yes/no)</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="when-to-use-asymptotic-methods">When to Use Asymptotic Methods<a class="anchor" aria-label="anchor" href="#when-to-use-asymptotic-methods"></a>
</h3>
<p>Asymptotic (normal approximation) methods are appropriate when:</p>
<ul>
<li><p><strong>Sample sizes are large</strong> (typically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &gt; 200</annotation></semantics></math>)</p></li>
<li><p><strong>Probabilities are not extreme</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.10</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">0.10 &lt; p &lt; 0.90</annotation></semantics></math>)</p></li>
<li><p><strong>Computational efficiency is important</strong></p></li>
</ul>
<p>For small to medium sample sizes or extreme probabilities, use
<strong>exact methods</strong> based on Homma and Yoshida (2025), which
can be computed using exact approaches without any approximations (see
<code><a href="../articles/two-binary-endpoints-exact.html">vignette("two-binary-endpoints-exact")</a></code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h2>
<div class="section level3">
<h3 id="model-and-assumptions">Model and Assumptions<a class="anchor" aria-label="anchor" href="#model-and-assumptions"></a>
</h3>
<p>Consider a two-arm parallel-group superiority trial comparing
treatment (group 1) with control (group 2). Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>
denote the sample sizes in the two groups, with allocation ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r = n_{1}/n_{2}</annotation></semantics></math>
(i.e., total sample size is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">N=n_{1}+n_{2}</annotation></semantics></math>).</p>
<p>For subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>n</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">i = 1, \ldots, n_j</annotation></semantics></math>)
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j = 1</annotation></semantics></math>:
treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">j = 2</annotation></semantics></math>:
control), we observe two binary <strong>outcomes</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mspace width="1.0em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">X_{i,j,k} \in \{0, 1\}, \quad k = 1, 2</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_{i,j,k} = 1</annotation></semantics></math>
indicates success and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_{i,j,k} = 0</annotation></semantics></math>
indicates failure for outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<p><strong>Marginal probabilities</strong>: Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">p_{j,k}</annotation></semantics></math>
denote the success probability for outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p_{j,k} = \text{P}(X_{i,j,k} = 1), \quad k = 1, 2</annotation></semantics></math></p>
<p>For details on the joint distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_{i,j,1}, X_{i,j,2})</annotation></semantics></math>,
see Homma and Yoshida (2025) Section 2.1 or Sozu et al. (2010).</p>
</div>
<div class="section level3">
<h3 id="correlation-structure">Correlation Structure<a class="anchor" aria-label="anchor" href="#correlation-structure"></a>
</h3>
<p>The correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
between the two binary outcomes in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is defined as (Homma and Yoshida, 2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>j</mi></msub><mo>=</mo><mtext mathvariant="normal">Cor</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><msqrt><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\rho_j = \text{Cor}(X_{i,j,1}, X_{i,j,2}) = \frac{\phi_j - p_{j,1}p_{j,2}}{\sqrt{p_{j,1}(1-p_{j,1})p_{j,2}(1-p_{j,2})}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_j = \text{P}(X_{i,j,1} = 1, X_{i,j,2} = 1)</annotation></semantics></math>
is the joint probability that both outcomes are successful.</p>
<p><strong>Practical interpretation</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>j</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_{j} &gt; 0</annotation></semantics></math>
means subjects who succeed on outcome 1 are more likely to succeed on
outcome 2.</p>
<p><strong>Valid correlation range</strong>: Because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; p_{j,k} &lt; 1</annotation></semantics></math>,
the correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\rho_{j}</annotation></semantics></math>
is not free to range over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math>,
but is bounded by (Homma and Yoshida, 2025, Equation 2):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>j</mi></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>⊆</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_j \in [L(p_{j,1}, p_{j,2}), U(p_{j,1}, p_{j,2})] \subseteq [-1, 1]</annotation></semantics></math></p>
<p>where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo>−</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo>,</mo><mo>−</mo><msqrt><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">L(p_{j,1}, p_{j,2}) = \max\left\{-\sqrt{\frac{p_{j,1}p_{j,2}}{(1-p_{j,1})(1-p_{j,2})}}, -\sqrt{\frac{(1-p_{j,1})(1-p_{j,2})}{p_{j,1}p_{j,2}}}\right\}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">{</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo>,</mo><msqrt><mfrac><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">U(p_{j,1}, p_{j,2}) = \min\left\{\sqrt{\frac{p_{j,1}(1-p_{j,2})}{p_{j,2}(1-p_{j,1})}}, \sqrt{\frac{p_{j,2}(1-p_{j,1})}{p_{j,1}(1-p_{j,2})}}\right\}</annotation></semantics></math></p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{j,1} = p_{j,2}</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">U(p_{j,1}, p_{j,2}) = 1</annotation></semantics></math>,
whereas
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L(p_{j,1}, p_{j,2}) = -1</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_{j,1} + p_{j,2} = 1</annotation></semantics></math>.</p>
<p>These bounds can be computed using the
<code><a href="../reference/corrbound2Binary.html">corrbound2Binary()</a></code> function in this package.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>We test superiority of treatment over control for both endpoints. The
<strong>endpoints</strong> for testing are the risk differences:</p>
<p><strong>For endpoint</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mrow><mn>0</mn><mi>k</mi></mrow></msub><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>≤</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> vs. </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mrow><mn>1</mn><mi>k</mi></mrow></msub><mo>:</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{H}_{0k}: p_{1,k} - p_{2,k} \leq 0 \text{ vs. } \text{H}_{1k}: p_{1,k} - p_{2,k} &gt; 0</annotation></semantics></math></p>
<p><strong>For co-primary endpoints</strong> (intersection-union
test):</p>
<p><strong>Null hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>∪</mo><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_{0} = \text{H}_{01} \cup \text{H}_{02}</annotation></semantics></math>
(at least one null is true)</p>
<p><strong>Alternative hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>∩</mo><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_{1} = \text{H}_{11} \cap \text{H}_{12}</annotation></semantics></math>
(both alternatives are true)</p>
<p><strong>Decision rule</strong>: Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
if and only if <strong>both</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><annotation encoding="application/x-tex">\text{H}_{01}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><annotation encoding="application/x-tex">\text{H}_{02}</annotation></semantics></math>
are rejected at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h3>
<p>Several test statistics are available for binary endpoints. We focus
on <strong>asymptotic normal approximation</strong> methods following
Sozu et al. (2010).</p>
<div class="section level4">
<h4 id="method-1-standard-normal-approximation-an">Method 1: Standard Normal Approximation (AN)<a class="anchor" aria-label="anchor" href="#method-1-standard-normal-approximation-an"></a>
</h4>
<p>For endpoint k, the test statistic without continuity correction is
<strong>(Equation 3 in Sozu et al., 2010)</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><mrow><mi>s</mi><msub><mi>e</mi><mrow><mi>k</mi><mn>0</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_k = \frac{\hat{p}_{1,k} - \hat{p}_{2,k}}{se_{k0}}</annotation></semantics></math></p>
<p>where:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msub><mi>e</mi><mrow><mi>k</mi><mn>0</mn></mrow></msub><mo>=</mo><msqrt><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mover><mi>p</mi><mo accent="true">‾</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">‾</mo></mover><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">se_{k0} = \sqrt{\left(\frac{1}{n_1} + \frac{1}{n_2}\right) \bar{p}_k(1 - \bar{p}_k)}</annotation></semantics></math></p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">‾</mo></mover><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mn>1</mn></msub><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\bar{p}_k = \frac{n_1 \hat{p}_{1,k} + n_2 \hat{p}_{2,k}}{n_1 + n_2}</annotation></semantics></math>
is the <strong>pooled proportion</strong> under the null hypothesis.</p>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mrow><mn>0</mn><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\text{H}_{0k}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Z_{k}</annotation></semantics></math>
asymptotically follows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{N}(0, 1)</annotation></semantics></math>.</p>
<p><strong>Power formula</strong> (Equation 4 in Sozu et al., 2010):</p>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mrow><mn>1</mn><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\text{H}_{1k}</annotation></semantics></math>
with true probabilities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">p_{1,k}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">p_{2,k}</annotation></semantics></math>,
the power for a single endpoint is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Power</mtext><mi>k</mi></msub><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>−</mo><mi>s</mi><msub><mi>e</mi><mrow><mi>k</mi><mn>0</mn></mrow></msub><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub></mrow><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Power}_k = \Phi\left(\frac{\delta_k - se_{k0} z_{1-\alpha}}{se_k}\right)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>=</mo><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta_k = p_{1,k} - p_{2,k}</annotation></semantics></math>
is the true risk difference</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub><mo>=</mo><msqrt><mrow><mfrac><msub><mi>v</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><msub><mi>v</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">se_k = \sqrt{\frac{v_{1,k}}{n_1} + \frac{v_{2,k}}{n_2}}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_{j,k} = p_{j,k}(1 - p_{j,k})</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><annotation encoding="application/x-tex">z_{1-\alpha}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\alpha)</annotation></semantics></math>
quantile of the standard normal distribution</li>
</ul>
</div>
<div class="section level4">
<h4 id="method-2-normal-approximation-with-continuity-correction-anc">Method 2: Normal Approximation with Continuity Correction (ANc)<a class="anchor" aria-label="anchor" href="#method-2-normal-approximation-with-continuity-correction-anc"></a>
</h4>
<p>To improve finite-sample performance, Yates’s continuity correction
is applied <strong>(Equation 5 in Sozu et al., 2010)</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><mi>c</mi></mrow><mrow><mi>s</mi><msub><mi>e</mi><mrow><mi>k</mi><mn>0</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_k = \frac{\hat{p}_{1,k} - \hat{p}_{2,k} - c}{se_{k0}}</annotation></semantics></math></p>
<p>where:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c = \frac{1}{2}\left(\frac{1}{n_1} + \frac{1}{n_2}\right)</annotation></semantics></math></p>
<p><strong>Power formula</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Power</mtext><mi>k</mi></msub><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>−</mo><mi>s</mi><msub><mi>e</mi><mrow><mi>k</mi><mn>0</mn></mrow></msub><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>−</mo><mi>c</mi></mrow><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Power}_k = \Phi\left(\frac{\delta_k - se_{k0} z_{1-\alpha} - c}{se_k}\right)</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="method-3-arcsine-transformation-as">Method 3: Arcsine Transformation (AS)<a class="anchor" aria-label="anchor" href="#method-3-arcsine-transformation-as"></a>
</h4>
<p>The arcsine-square-root transformation stabilizes variance
<strong>(Equation 6 in Sozu et al., 2010)</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>s</mi><mi>e</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_k = \frac{\arcsin(\sqrt{\hat{p}_{1,k}}) - \arcsin(\sqrt{\hat{p}_{2,k}})}{se}</annotation></semantics></math></p>
<p>where:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msqrt><mrow><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">se = \frac{1}{2}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}</annotation></semantics></math></p>
<p><strong>Power formula</strong>:</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>δ</mi><mi>k</mi><mtext mathvariant="normal">AS</mtext></msubsup><mo>=</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msub><mi>p</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msub><mi>p</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta_k^\text{AS} = \arcsin(\sqrt{p_{1k}}) - \arcsin(\sqrt{p_{2k}})</annotation></semantics></math>,
then:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Power</mtext><mi>k</mi></msub><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msubsup><mi>δ</mi><mi>k</mi><mtext mathvariant="normal">AS</mtext></msubsup><mrow><mi>s</mi><mi>e</mi></mrow></mfrac><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Power}_k = \Phi\left(\frac{\delta_k^\text{AS}}{se} - z_{1-\alpha}\right)</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="method-4-arcsine-transformation-with-continuity-correction-asc">Method 4: Arcsine Transformation with Continuity Correction
(ASc)<a class="anchor" aria-label="anchor" href="#method-4-arcsine-transformation-with-continuity-correction-asc"></a>
</h4>
<p>Walters’ continuity correction for the arcsine method
<strong>(Equation 7 in Sozu et al., 2010)</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>s</mi><mi>e</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Z_k = \frac{\arcsin(\sqrt{\hat{p}_{1,k} + c_1}) - \arcsin(\sqrt{\hat{p}_{2,k} + c_2})}{se}</annotation></semantics></math></p>
<p>where:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi>n</mi><mn>1</mn></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">c_1 = -\frac{1}{2n_1}, \quad c_2 = \frac{1}{2n_2}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msqrt><mrow><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">se = \frac{1}{2}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}</annotation></semantics></math></p>
<p><strong>Power formula</strong>:</p>
<p>Let:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>δ</mi><mi>k</mi><mrow><mi>A</mi><mi>S</mi><mi>c</mi></mrow></msubsup><mo>=</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>arcsin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta_k^{ASc} = \arcsin(\sqrt{p_{1,k} + c_1}) - \arcsin(\sqrt{p_{2,k} + c_2})</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>v</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow><mi>c</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_{j,k}^c = (p_{j,k} + c_j)(1 - p_{j,k} - c_j)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub><mo>=</mo><msqrt><mrow><mfrac><msub><mi>v</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mrow><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub><msubsup><mi>v</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>c</mi></msubsup></mrow></mfrac><mo>+</mo><mfrac><msub><mi>v</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow></msub><mrow><mn>4</mn><msub><mi>n</mi><mn>2</mn></msub><msubsup><mi>v</mi><mrow><mn>2</mn><mo>,</mo><mi>k</mi></mrow><mi>c</mi></msubsup></mrow></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">se_k = \sqrt{\frac{v_{1,k}}{4n_1 v_{1,k}^c} + \frac{v_{2,k}}{4n_2 v_{2,k}^c}}</annotation></semantics></math></li>
</ul>
<p>Then:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Power</mtext><mi>k</mi></msub><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msubsup><mi>δ</mi><mi>k</mi><mrow><mi>A</mi><mi>S</mi><mi>c</mi></mrow></msubsup><mo>−</mo><mi>s</mi><mi>e</mi><mo>⋅</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub></mrow><mrow><mi>s</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Power}_k = \Phi\left(\frac{\delta_k^{ASc} - se \cdot z_{1-\alpha}}{se_k}\right)</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="joint-distribution-and-correlation">Joint Distribution and Correlation<a class="anchor" aria-label="anchor" href="#joint-distribution-and-correlation"></a>
</h3>
<p>Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{H}_{1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_{1}, Z_{2})</annotation></semantics></math>
asymptotically follows a bivariate normal distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Z</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Z</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">BN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ω</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ω</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>γ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>γ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{pmatrix} Z_1 \\ Z_2 \end{pmatrix} \sim \text{BN}\left(\begin{pmatrix} \omega_1 \\ \omega_2 \end{pmatrix}, \begin{pmatrix} 1 &amp; \gamma \\ \gamma &amp; 1 \end{pmatrix}\right)</annotation></semantics></math></p>
<p>The correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
between test statistics depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_{1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\rho_{2}</annotation></semantics></math>,
and the marginal probabilities. For details on the derivation and
approximation formulas, see Sozu et al. (2010) and Homma and Yoshida
(2025). This approximation is implemented in the package functions.</p>
</div>
<div class="section level3">
<h3 id="power-calculation">Power Calculation<a class="anchor" aria-label="anchor" href="#power-calculation"></a>
</h3>
<p>The overall power (probability of rejecting both null hypotheses)
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>∣</mo><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \text{P}(Z_1 &gt; z_{1-\alpha} \text{ and } Z_2 &gt; z_{1-\alpha} \mid \text{H}_1)</annotation></semantics></math></p>
<p>Using the bivariate normal distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><msub><mi>Φ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>+</mo><msub><mi>ω</mi><mn>1</mn></msub><mo>,</mo><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>+</mo><msub><mi>ω</mi><mn>2</mn></msub><mo>∣</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \Phi_2(-z_{1-\alpha} + \omega_1, -z_{1-\alpha} + \omega_2 \mid \gamma)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>∣</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi_{2}(a, b \mid \gamma)</annotation></semantics></math>
is the CDF of the standard bivariate normal distribution with
correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="sample-size-calculation">Sample Size Calculation<a class="anchor" aria-label="anchor" href="#sample-size-calculation"></a>
</h3>
<p>For target power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 - \beta</annotation></semantics></math>
and balanced design
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n_{1} = n_{2} = n</annotation></semantics></math>),
we solve the power formula shown above numerically for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_{2}</annotation></semantics></math>.
Then, the total sample size is obtained as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">N = (1+r)n_{2}</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="replicating-sozu-et-al--2010-table-iii">Replicating Sozu et al. (2010) Table III<a class="anchor" aria-label="anchor" href="#replicating-sozu-et-al--2010-table-iii"></a>
</h2>
<p>Table III from Sozu et al. (2010) shows sample sizes for various
probability combinations and correlations using the AN, ANc, AS, and ASc
test methods. Note that exact methods based on Fisher’s exact test
(Homma and Yoshida, 2025) can provide more accurate sample sizes for
small to medium sample sizes, but are not included in this table as they
were not available in Sozu et al. (2010).</p>
<p>The notation used in the function is: <code>p11</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,1}</annotation></semantics></math>,
<code>p12</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,2}</annotation></semantics></math>,
<code>p21</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,1}</annotation></semantics></math>,
<code>p22</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,2}</annotation></semantics></math>,
where the first subscript denotes the group (1 = treatment, 2 = control)
and the second subscript denotes the endpoint (1 or 2).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recreate Sozu et al. (2010) Table III</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">param_grid_bin_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.70</span>, <span class="fl">0.87</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>  p12 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.70</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span><span class="op">)</span>,</span>
<span>  p22 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_bin_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  <span class="va">bind_rows</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AN"</span>, <span class="st">"ANc"</span>, <span class="st">"AS"</span>, <span class="st">"ASc"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="va">bind_rows</span>,</span>
<span>      <span class="fu"><a href="../reference/design_table.html">design_table</a></span><span class="op">(</span></span>
<span>        param_grid <span class="op">=</span> <span class="va">param_grid_bin_ss</span>,</span>
<span>        rho_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>        beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        endpoint_type <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>        Test <span class="op">=</span> <span class="va">test</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"rho"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"N"</span>,</span>
<span>    names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="va">parse_number</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Test</span>,  values_from <span class="op">=</span> <span class="va">N</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">AN</span>, <span class="va">ANc</span>, <span class="va">AS</span>, <span class="va">ASc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_bin_ss</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Table III: Sample Size per Group (n) for Two Co-Primary Binary Endpoints (α = 0.025, 1-β = 0.80)^a,b^"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p₁,₁"</span>, <span class="st">"p₁,₂"</span>, <span class="st">"p₂,₁"</span>, <span class="st">"p₂,₂"</span>, <span class="st">"ρ"</span>, <span class="st">"AN"</span>, <span class="st">"ANc"</span>, <span class="st">"AS"</span>, <span class="st">"ASc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table III: Sample Size per Group (n) for Two Co-Primary Binary
Endpoints (α = 0.025, 1-β = 0.80)<sup>a,b</sup>
</caption>
<thead><tr class="header">
<th align="right">p₁,₁</th>
<th align="right">p₁,₂</th>
<th align="right">p₂,₁</th>
<th align="right">p₂,₂</th>
<th align="right">ρ</th>
<th align="right">AN</th>
<th align="right">ANc</th>
<th align="right">AS</th>
<th align="right">ASc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">124</td>
<td align="right">134</td>
<td align="right">124</td>
<td align="right">134</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">122</td>
<td align="right">132</td>
<td align="right">122</td>
<td align="right">132</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">119</td>
<td align="right">129</td>
<td align="right">119</td>
<td align="right">129</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">116</td>
<td align="right">126</td>
<td align="right">116</td>
<td align="right">126</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">109</td>
<td align="right">119</td>
<td align="right">109</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">121</td>
<td align="right">131</td>
<td align="right">119</td>
<td align="right">130</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">118</td>
<td align="right">128</td>
<td align="right">116</td>
<td align="right">127</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">115</td>
<td align="right">125</td>
<td align="right">113</td>
<td align="right">124</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">81</td>
<td align="right">91</td>
<td align="right">78</td>
<td align="right">88</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">79</td>
<td align="right">89</td>
<td align="right">76</td>
<td align="right">86</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">77</td>
<td align="right">87</td>
<td align="right">74</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">72</td>
<td align="right">82</td>
<td align="right">69</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">571</td>
<td align="right">610</td>
<td align="right">557</td>
<td align="right">596</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">556</td>
<td align="right">596</td>
<td align="right">543</td>
<td align="right">582</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">542</td>
<td align="right">581</td>
<td align="right">529</td>
<td align="right">568</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">507</td>
<td align="right">546</td>
<td align="right">495</td>
<td align="right">534</td>
</tr>
</tbody>
</table>
<p><sup>a</sup> AN: Asymptotic normal test without continuity
correction; ANc: Asymptotic normal test with continuity correction; AS:
Arcsine transformation without continuity correction; ASc: Arcsine
transformation with continuity correction.</p>
<p><sup>b</sup> Some values may differ by 1-2 subjects from Sozu et
al. (2010) Table III due to numerical differences in computing the
bivariate normal cumulative distribution function between SAS and R
implementations. Power calculations at the reported sample sizes confirm
the accuracy of the values presented here.</p>
<div class="section level3">
<h3 id="key-findings">Key Findings<a class="anchor" aria-label="anchor" href="#key-findings"></a>
</h3>
<p><strong>Effect of correlation</strong>:</p>
<ul>
<li>
<strong>Positive correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho &gt; 0</annotation></semantics></math>)
reduces required sample size</li>
<li>
<strong>Negative correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho &lt; 0</annotation></semantics></math>)
increases required sample size</li>
<li>
<strong>Zero correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>)
provides intermediate sample size</li>
</ul>
<p><strong>Test method comparison</strong>:</p>
<ul>
<li>
<strong>AN</strong>: Generally smallest sample size, most
efficient</li>
<li>
<strong>ANc</strong>: Slightly larger than AN due to continuity
correction</li>
<li>
<strong>AS</strong>: Similar to AN for moderate probabilities</li>
<li>
<strong>ASc</strong>: Largest sample size, most conservative</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="basic-usage-examples">Basic Usage Examples<a class="anchor" aria-label="anchor" href="#basic-usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-equal-effect-sizes">Example 1: Equal Effect Sizes<a class="anchor" aria-label="anchor" href="#example-1-equal-effect-sizes"></a>
</h3>
<p>Calculate sample size when both endpoints have equal effect
sizes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Both endpoints: 70% vs 50% (20% difference)</span></span>
<span><span class="co"># p_{1,1} = p_{1,2} = 0.7 (treatment group)</span></span>
<span><span class="co"># p_{2,1} = p_{2,2} = 0.5 (control group)</span></span>
<span><span class="va">ss_equal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.7</span>, p12 <span class="op">=</span> <span class="fl">0.7</span>,  <span class="co"># Treatment group</span></span>
<span>  p21 <span class="op">=</span> <span class="fl">0.5</span>, p22 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Control group</span></span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in treatment group</span></span>
<span>  rho2 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in control group</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Balanced allocation</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss_equal</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 116</span></span>
<span><span class="co">#&gt;              n2 = 116</span></span>
<span><span class="co">#&gt;               N = 232</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.7</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.5, 0.5</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span></code></pre></div>
<p><strong>Note</strong>: In the function, <code>p11</code> corresponds
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,1}</annotation></semantics></math>
(success probability for endpoint 1 in treatment group),
<code>p12</code> to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{1,2}</annotation></semantics></math>,
<code>p21</code> to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,1}</annotation></semantics></math>,
and <code>p22</code> to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">p_{2,2}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="example-2-unequal-effect-sizes">Example 2: Unequal Effect Sizes<a class="anchor" aria-label="anchor" href="#example-2-unequal-effect-sizes"></a>
</h3>
<p>When effect sizes differ, the endpoint with smaller effect
dominates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Endpoint 1: 75% vs 65% (10% difference)</span></span>
<span><span class="co"># Endpoint 2: 80% vs 60% (20% difference)</span></span>
<span><span class="va">ss_unequal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.75</span>, p12 <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.65</span>, p22 <span class="op">=</span> <span class="fl">0.60</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.3</span>, rho2 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss_unequal</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 329</span></span>
<span><span class="co">#&gt;              n2 = 329</span></span>
<span><span class="co">#&gt;               N = 658</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.75, 0.8</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.65, 0.6</span></span>
<span><span class="co">#&gt;             rho = 0.3, 0.3</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span>
<span></span>
<span><span class="co"># Compare with individual endpoint sample sizes</span></span>
<span><span class="va">ss_ep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss1BinaryApprox.html">ss1BinaryApprox</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.75</span>, p2 <span class="op">=</span> <span class="fl">0.65</span>, r <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.2</span>, Test <span class="op">=</span> <span class="st">"AN"</span><span class="op">)</span></span>
<span><span class="va">ss_ep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss1BinaryApprox.html">ss1BinaryApprox</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.80</span>, p2 <span class="op">=</span> <span class="fl">0.60</span>, r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.2</span>, Test <span class="op">=</span> <span class="st">"AN"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Single endpoint 1 sample size:"</span>, <span class="va">ss_ep1</span><span class="op">$</span><span class="va">n2</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Single endpoint 1 sample size: 329</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Single endpoint 2 sample size:"</span>, <span class="va">ss_ep2</span><span class="op">$</span><span class="va">n2</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Single endpoint 2 sample size: 82</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Co-primary sample size:"</span>, <span class="va">ss_unequal</span><span class="op">$</span><span class="va">n2</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Co-primary sample size: 329</span></span></code></pre></div>
<p>The co-primary design requires approximately the same sample size as
the endpoint with smaller effect size.</p>
</div>
<div class="section level3">
<h3 id="example-3-effect-of-correlation">Example 3: Effect of Correlation<a class="anchor" aria-label="anchor" href="#example-3-effect-of-correlation"></a>
</h3>
<p>Demonstrate how correlation affects sample size:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed effect sizes: p_{1,1} = p_{1,2} = 0.7, p_{2,1} = p_{2,2} = 0.5</span></span>
<span><span class="va">p11</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">p21</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">p12</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">p22</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Range of correlations</span></span>
<span><span class="va">rho_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_by_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>    p11 <span class="op">=</span> <span class="va">p11</span>, p12 <span class="op">=</span> <span class="va">p12</span>,</span>
<span>    p21 <span class="op">=</span> <span class="va">p21</span>, p22 <span class="op">=</span> <span class="va">p22</span>,</span>
<span>    rho1 <span class="op">=</span> <span class="va">rho</span>, rho2 <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ss</span><span class="op">$</span><span class="va">n2</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rho <span class="op">=</span> <span class="va">rho_values</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="va">ss_by_rho</span>,</span>
<span>  N_total <span class="op">=</span> <span class="va">ss_by_rho</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">result_df</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Sample Size vs Correlation (p₁,₁ = p₁,₂ = 0.7, p₂,₁ = p₂,₂ = 0.5)"</span>,</span>
<span>      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ρ"</span>, <span class="st">"n per group"</span>, <span class="st">"N total"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sample Size vs Correlation (p₁,₁ = p₁,₂ = 0.7, p₂,₁ = p₂,₂ =
0.5)</caption>
<thead><tr class="header">
<th align="right">ρ</th>
<th align="right">n per group</th>
<th align="right">N total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">-0.3</td>
<td align="right">124</td>
<td align="right">248</td>
</tr>
<tr class="even">
<td align="right">0.0</td>
<td align="right">122</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td align="right">0.3</td>
<td align="right">119</td>
<td align="right">238</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">116</td>
<td align="right">232</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">109</td>
<td align="right">218</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho_values</span>, <span class="va">ss_by_rho</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Correlation (ρ)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Sample size per group (n)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Effect of Correlation on Sample Size"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ss_by_rho</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.9</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ss_by_rho</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="two-binary-endpoints-approx_files/figure-html/correlation_effect-1.png" class="r-plt" width="672"></p>
<p><strong>Interpretation</strong>: Higher positive correlation
substantially reduces required sample size.</p>
</div>
<div class="section level3">
<h3 id="example-4-unbalanced-allocation">Example 4: Unbalanced Allocation<a class="anchor" aria-label="anchor" href="#example-4-unbalanced-allocation"></a>
</h3>
<p>Calculate sample size with unequal group allocation:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2:1 allocation (treatment:control)</span></span>
<span><span class="va">ss_unbalanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.7</span>, p12 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.5</span>, p22 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">2</span>,  <span class="co"># 2:1 allocation</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss_unbalanced</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 172</span></span>
<span><span class="co">#&gt;              n2 = 86</span></span>
<span><span class="co">#&gt;               N = 258</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.7</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.5, 0.5</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 2</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total sample size:"</span>, <span class="va">ss_unbalanced</span><span class="op">$</span><span class="va">N</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total sample size: 258</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-verification">Power Verification<a class="anchor" aria-label="anchor" href="#power-verification"></a>
</h2>
<p>Verify that calculated sample sizes achieve target power:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use result from Example 1</span></span>
<span><span class="va">power_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power2BinaryApprox.html">power2BinaryApprox</a></span><span class="op">(</span></span>
<span>  n1 <span class="op">=</span> <span class="va">ss_equal</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>  n2 <span class="op">=</span> <span class="va">ss_equal</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>  p11 <span class="op">=</span> <span class="fl">0.7</span>, p12 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.5</span>, p22 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target power: 0.80\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target power: 0.80</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Endpoint 1):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Endpoint 1): 0.8798</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Endpoint 2):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">power2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Endpoint 2): 0.8798</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved power (Co-primary):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">$</span><span class="va">powerCoprimary</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved power (Co-primary): 0.8016</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-of-test-methods">Comparison of Test Methods<a class="anchor" aria-label="anchor" href="#comparison-of-test-methods"></a>
</h2>
<p>Compare the four asymptotic test methods:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fixed design parameters</span></span>
<span><span class="va">p11</span> <span class="op">&lt;-</span> <span class="fl">0.80</span></span>
<span><span class="va">p12</span> <span class="op">&lt;-</span> <span class="fl">0.70</span></span>
<span><span class="va">p21</span> <span class="op">&lt;-</span> <span class="fl">0.55</span></span>
<span><span class="va">p22</span> <span class="op">&lt;-</span> <span class="fl">0.45</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span></span>
<span><span class="co"># Calculate for each method</span></span>
<span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AN"</span>, <span class="st">"ANc"</span>, <span class="st">"AS"</span>, <span class="st">"ASc"</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>        p11 <span class="op">=</span> <span class="va">p11</span>, p12 <span class="op">=</span> <span class="va">p12</span>,</span>
<span>        p21 <span class="op">=</span> <span class="va">p21</span>, p22 <span class="op">=</span> <span class="va">p22</span>,</span>
<span>        rho1 <span class="op">=</span> <span class="va">rho</span>, rho2 <span class="op">=</span> <span class="va">rho</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>        beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        Test <span class="op">=</span> <span class="va">method</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        Method <span class="op">=</span> <span class="va">method</span>,</span>
<span>        n_per_group <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">n2</span>,</span>
<span>        N_total <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">N</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison_table</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison of Test Methods (p₁,₁ = p₁,₂ = 0.7, p₂,₁ = p₂,₂ = 0.5, ρ = 0.5)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of Test Methods (p₁,₁ = p₁,₂ = 0.7, p₂,₁ = p₂,₂ =
0.5, ρ = 0.5)</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">n_per_group</th>
<th align="right">N_total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AN</td>
<td align="right">69</td>
<td align="right">138</td>
</tr>
<tr class="even">
<td align="left">ANc</td>
<td align="right">77</td>
<td align="right">154</td>
</tr>
<tr class="odd">
<td align="left">AS</td>
<td align="right">69</td>
<td align="right">138</td>
</tr>
<tr class="even">
<td align="left">ASc</td>
<td align="right">76</td>
<td align="right">152</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="design-considerations">Design Considerations<a class="anchor" aria-label="anchor" href="#design-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Estimate correlation</strong>: Use pilot data or
historical information; be conservative if uncertain</p></li>
<li><p><strong>Consider asymmetric effects</strong>: Use actual effect
sizes rather than assuming equality</p></li>
<li><p><strong>Balanced allocation</strong>: Generally more efficient
unless practical constraints require otherwise</p></li>
<li><p><strong>Test method selection</strong>: AN is most common; use
continuity correction for added conservatism</p></li>
<li><p><strong>Sample size sensitivity</strong>: Calculate for range of
plausible correlations and effect sizes</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-exact-methods-instead">When to Use Exact Methods Instead<a class="anchor" aria-label="anchor" href="#when-to-use-exact-methods-instead"></a>
</h3>
<p>Use exact methods (<code>ss2BinaryExact</code>) based on Homma and
Yoshida (2025) when:</p>
<ul>
<li>Small to medium sample sizes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &lt; 200</annotation></semantics></math>)</li>
<li>Extreme probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">p &gt; 0.9</annotation></semantics></math>)</li>
<li>Strict Type I error control required</li>
<li>Regulatory preference for exact tests</li>
</ul>
<p>Exact methods using Fisher’s exact test can provide more accurate
sample sizes and better Type I error control in these situations.</p>
</div>
<div class="section level3">
<h3 id="asymptotic-validity">Asymptotic Validity<a class="anchor" aria-label="anchor" href="#asymptotic-validity"></a>
</h3>
<p>These asymptotic methods are appropriate when:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &gt; 200</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.1</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">0.1 &lt; p &lt; 0.9</annotation></semantics></math></li>
<li>Computational efficiency is important</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Homma, G., &amp; Yoshida, T. (2025). Exact power and sample size in
clinical trials with two co-primary binary endpoints. <em>Statistical
Methods in Medical Research</em>, 34(1), 1-19.</p>
<p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2010). Sample size
determination in clinical trials with multiple co-primary binary
endpoints. <em>Statistics in Medicine</em>, 29(21), 2169-2179.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  
</body>
</html>
