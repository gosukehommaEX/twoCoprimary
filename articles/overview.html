<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Overview of Two Co-Primary Endpoints Analysis • twoCoprimary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overview of Two Co-Primary Endpoints Analysis">
</head>
<body>
<p>








  pkgdown/mathjax.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">twoCoprimary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/two-continuous-endpoints.html">Two Continuous Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-approx.html">Two Binary Endpoints (Asymptotic)</a></li>
    <li><a class="dropdown-item" href="../articles/two-binary-endpoints-exact.html">Two Binary Endpoints (Exact)</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-continuous-binary.html">Mixed Continuous and Binary</a></li>
    <li><a class="dropdown-item" href="../articles/mixed-count-continuous.html">Mixed Count and Continuous</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/twoCoprimary" aria-label="View source on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Overview of Two Co-Primary Endpoints Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/twoCoprimary/blob/main/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>twoCoprimary</code> package provides comprehensive tools
for sample size calculation and power analysis in clinical trials with
two co-primary endpoints. This package implements methodologies from
multiple publications and supports various endpoint types.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaex.github.io/twoCoprimary/" class="external-link">twoCoprimary</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-are-co-primary-endpoints">What are Co-Primary Endpoints?<a class="anchor" aria-label="anchor" href="#what-are-co-primary-endpoints"></a>
</h2>
<p>In clinical trials, <strong>co-primary endpoints</strong> are
multiple primary endpoints that must <strong>all</strong> show
statistically significant treatment effects for the trial to be
considered successful. This is in contrast to multiple primary endpoints
where demonstrating an effect on <strong>any one</strong> endpoint is
sufficient.</p>
<div class="section level3">
<h3 id="statistical-properties">Statistical Properties<a class="anchor" aria-label="anchor" href="#statistical-properties"></a>
</h3>
<ul>
<li>
<strong>No multiplicity adjustment needed</strong> for Type I error
control</li>
<li>The overall Type I error rate is controlled at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
without Bonferroni correction</li>
<li>The overall power is the joint probability: Power =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">Reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and Reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(\text{Reject } \text{H}_{01} \text{ and Reject } \text{H}_{02})</annotation></semantics></math>
</li>
<li>Accounting for <strong>correlation</strong> between endpoints can
improve efficiency</li>
</ul>
</div>
<div class="section level3">
<h3 id="hypotheses-structure">Hypotheses Structure<a class="anchor" aria-label="anchor" href="#hypotheses-structure"></a>
</h3>
<p>For two co-primary endpoints, we test:</p>
<p><strong>Null hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><mo>∪</mo><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_{0} = \text{H}_{01} \cup \text{H}_{02}</annotation></semantics></math>
(at least one null hypothesis is true)</p>
<p><strong>Alternative hypothesis</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo>=</mo><msub><mtext mathvariant="normal">H</mtext><mn>11</mn></msub><mo>∩</mo><msub><mtext mathvariant="normal">H</mtext><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\text{H}_{1} = \text{H}_{11} \cap \text{H}_{12}</annotation></semantics></math>
(both alternative hypotheses are true)</p>
<p>We reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
only if <strong>both</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>01</mn></msub><annotation encoding="application/x-tex">\text{H}_{01}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>02</mn></msub><annotation encoding="application/x-tex">\text{H}_{02}</annotation></semantics></math>
are rejected at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h2>
<div class="section level3">
<h3 id="intersection-union-test-iut">Intersection-Union Test (IUT)<a class="anchor" aria-label="anchor" href="#intersection-union-test-iut"></a>
</h3>
<p>The co-primary endpoint framework is based on the intersection-union
test principle. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Z_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Z_{2}</annotation></semantics></math>
be the test statistics for endpoints 1 and 2, respectively.</p>
<p><strong>Decision rule</strong>: Reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
if and only if:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{1} &gt; z_{1-\alpha} \text{ and } Z_{2} &gt; z_{1-\alpha}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><annotation encoding="application/x-tex">z_{1-\alpha}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\alpha)</annotation></semantics></math>-th
quantile of the standard normal distribution.</p>
</div>
<div class="section level3">
<h3 id="type-i-error-control">Type I Error Control<a class="anchor" aria-label="anchor" href="#type-i-error-control"></a>
</h3>
<p>The overall Type I error rate is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mtext mathvariant="normal">overall</mtext></msub><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">Reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mo>∣</mo><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> true</mtext></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_{\text{overall}} = \Pr(\text{Reject } \text{H}_{0} \mid \text{H}_{0} \text{ true})</annotation></semantics></math></p>
<p>Under the intersection-union test, this is automatically controlled
at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
without adjustment:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mtext mathvariant="normal">overall</mtext></msub><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha_{\text{overall}} \leq \alpha</annotation></semantics></math></p>
<p>This is because rejecting when <strong>both</strong> statistics
exceed the threshold is more conservative than rejecting when
<strong>either</strong> statistic exceeds the threshold.</p>
</div>
<div class="section level3">
<h3 id="overall-power">Overall Power<a class="anchor" aria-label="anchor" href="#overall-power"></a>
</h3>
<p>Under the alternative hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{H}_{1}</annotation></semantics></math>,
the overall power is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>∣</mo><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \Pr(Z_{1} &gt; z_{1-\alpha} \text{ and } Z_{2} &gt; z_{1-\alpha} \mid \text{H}_{1})</annotation></semantics></math></p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_{1}, Z_{2})</annotation></semantics></math>
follow a bivariate normal distribution with correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><msub><mi>Φ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>+</mo><msub><mi>ω</mi><mn>1</mn></msub><mo>,</mo><mo>−</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi></mrow></msub><mo>+</mo><msub><mi>ω</mi><mn>2</mn></msub><mo>∣</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \beta = \Phi_{2}(-z_{1-\alpha} + \omega_{1}, -z_{1-\alpha} + \omega_{2} \mid \rho)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo>,</mo><mo>⋅</mo><mo>∣</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi_{2}(\cdot, \cdot \mid \rho)</annotation></semantics></math>
is the bivariate normal cumulative distribution function with
correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ω</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\omega_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ω</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\omega_{2}</annotation></semantics></math>
are the non-centrality parameters under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>1</mn></msub><annotation encoding="application/x-tex">\text{H}_{1}</annotation></semantics></math>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="impact-of-correlation">Impact of Correlation<a class="anchor" aria-label="anchor" href="#impact-of-correlation"></a>
</h3>
<p>The correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
between test statistics affects the overall power:</p>
<ul>
<li>
<strong>Positive correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho &gt; 0</annotation></semantics></math>):
Increases power and reduces required sample size</li>
<li>
<strong>Zero correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>):
Test statistics are independent</li>
<li>
<strong>Negative correlation</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho &lt; 0</annotation></semantics></math>):
Decreases power and increases required sample size</li>
</ul>
<p><strong>Key insight</strong>: Accounting for positive correlation
between endpoints can lead to substantial sample size reductions
(typically 5-15% for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho = 0.5</annotation></semantics></math>-0.8)
compared to assuming independence.</p>
</div>
</div>
<div class="section level2">
<h2 id="supported-endpoint-types">Supported Endpoint Types<a class="anchor" aria-label="anchor" href="#supported-endpoint-types"></a>
</h2>
<p>The package supports five combinations of co-primary endpoints:</p>
<div class="section level3">
<h3 id="two-continuous-endpoints">1. Two Continuous Endpoints<a class="anchor" aria-label="anchor" href="#two-continuous-endpoints"></a>
</h3>
<p><strong>Use case</strong>: Trials measuring two continuous outcomes
(e.g., systolic and diastolic blood pressure)</p>
<p><strong>Statistical model</strong>: Both endpoints follow normal
distributions</p>
<p><strong>Key functions</strong>:</p>
<ul>
<li>
<code><a href="../reference/ss2Continuous.html">ss2Continuous()</a></code>: Sample size calculation</li>
<li>
<code><a href="../reference/power2Continuous.html">power2Continuous()</a></code>: Power calculation</li>
<li>
<code><a href="../reference/twoCoprimary2Continuous.html">twoCoprimary2Continuous()</a></code>: Unified interface for
both</li>
</ul>
<p><strong>Reference</strong>: Sozu et al. (2011)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Two continuous endpoints with correlation rho = 0.5</span></span>
<span><span class="fu"><a href="../reference/ss2Continuous.html">ss2Continuous</a></span><span class="op">(</span></span>
<span>  delta1 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Standardized effect size for endpoint 1</span></span>
<span>  delta2 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Standardized effect size for endpoint 2</span></span>
<span>  sd1 <span class="op">=</span> <span class="fl">1</span>,       <span class="co"># Standard deviation for endpoint 1</span></span>
<span>  sd2 <span class="op">=</span> <span class="fl">1</span>,       <span class="co"># Standard deviation for endpoint 2</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,     <span class="co"># Correlation between endpoints</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># Balanced allocation</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  known_var <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two continuous co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 79</span></span>
<span><span class="co">#&gt;              n2 = 79</span></span>
<span><span class="co">#&gt;               N = 158</span></span>
<span><span class="co">#&gt;           delta = 0.5, 0.5</span></span>
<span><span class="co">#&gt;              sd = 1, 1</span></span>
<span><span class="co">#&gt;             rho = 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;       known_var = TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-binary-endpoints-asymptotic-approximation">2. Two Binary Endpoints (Asymptotic Approximation)<a class="anchor" aria-label="anchor" href="#two-binary-endpoints-asymptotic-approximation"></a>
</h3>
<p><strong>Use case</strong>: Trials with two binary outcomes using
normal approximation (large sample)</p>
<p><strong>Statistical model</strong>: Binary endpoints with asymptotic
normal approximation</p>
<p><strong>Key functions</strong>:</p>
<ul>
<li>
<code><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox()</a></code>: Sample size calculation</li>
<li>
<code><a href="../reference/power2BinaryApprox.html">power2BinaryApprox()</a></code>: Power calculation</li>
<li>
<code><a href="../reference/twoCoprimary2BinaryApprox.html">twoCoprimary2BinaryApprox()</a></code>: Unified interface for
both</li>
</ul>
<p><strong>Reference</strong>: Sozu et al. (2010)</p>
<p><strong>Supported test methods</strong>:</p>
<ul>
<li>AN: Asymptotic normal test without continuity correction</li>
<li>ANc: Asymptotic normal test with continuity correction</li>
<li>AS: Arcsine transformation without continuity correction</li>
<li>ASc: Arcsine transformation with continuity correction</li>
</ul>
<p><strong>When to use</strong>: Large sample sizes (typically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &gt; 200</annotation></semantics></math>)
and probabilities not too extreme
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.1</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">0.1 &lt; p &lt; 0.9</annotation></semantics></math>)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Two binary endpoints</span></span>
<span><span class="fu"><a href="../reference/ss2BinaryApprox.html">ss2BinaryApprox</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.7</span>, p12 <span class="op">=</span> <span class="fl">0.6</span>,  <span class="co"># Endpoint 1 and 2 in treatment group</span></span>
<span>  p21 <span class="op">=</span> <span class="fl">0.4</span>, p22 <span class="op">=</span> <span class="fl">0.3</span>,  <span class="co"># Endpoint 1 and 2 in control group</span></span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in treatment group</span></span>
<span>  rho2 <span class="op">=</span> <span class="fl">0.5</span>,            <span class="co"># Correlation in control group</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Balanced allocation</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 52</span></span>
<span><span class="co">#&gt;              n2 = 52</span></span>
<span><span class="co">#&gt;               N = 104</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.6</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.4, 0.3</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-binary-endpoints-exact-methods">3. Two Binary Endpoints (Exact Methods)<a class="anchor" aria-label="anchor" href="#two-binary-endpoints-exact-methods"></a>
</h3>
<p><strong>Use case</strong>: Small to medium sample sizes requiring
exact inference</p>
<p><strong>Statistical model</strong>: Binary endpoints with exact
tests</p>
<p><strong>Key functions</strong>:</p>
<ul>
<li>
<code><a href="../reference/ss2BinaryExact.html">ss2BinaryExact()</a></code>: Sample size calculation using exact
tests</li>
<li>
<code><a href="../reference/power2BinaryExact.html">power2BinaryExact()</a></code>: Exact power calculation</li>
<li>
<code><a href="../reference/twoCoprimary2BinaryExact.html">twoCoprimary2BinaryExact()</a></code>: Unified interface for
both</li>
</ul>
<p><strong>Reference</strong>: Homma and Yoshida (2025)</p>
<p><strong>Supported tests</strong>:</p>
<ul>
<li>Chisq: Chi-squared test</li>
<li>Fisher: Fisher’s exact test (conditional test)</li>
<li>Fisher-midP: Fisher’s mid-p test</li>
<li>Z-pool: Z-pooled exact unconditional test</li>
<li>Boschloo: Boschloo’s exact unconditional test</li>
</ul>
<p><strong>When to use</strong>: Small/medium samples
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &lt; 200</annotation></semantics></math>),
extreme probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">p &gt; 0.9</annotation></semantics></math>),
or when strict Type I error control is required</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Exact methods for small samples</span></span>
<span><span class="fu"><a href="../reference/ss2BinaryExact.html">ss2BinaryExact</a></span><span class="op">(</span></span>
<span>  p11 <span class="op">=</span> <span class="fl">0.7</span>, p12 <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  p21 <span class="op">=</span> <span class="fl">0.4</span>, p22 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"Fisher"</span>  <span class="co"># or "Chisq", "Fisher-midP", "Z-pool", "Boschloo"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for two binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 59</span></span>
<span><span class="co">#&gt;              n2 = 59</span></span>
<span><span class="co">#&gt;               N = 118</span></span>
<span><span class="co">#&gt;     p (group 1) = 0.7, 0.6</span></span>
<span><span class="co">#&gt;     p (group 2) = 0.4, 0.3</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = Fisher</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mixed-continuous-and-binary-endpoints">4. Mixed Continuous and Binary Endpoints<a class="anchor" aria-label="anchor" href="#mixed-continuous-and-binary-endpoints"></a>
</h3>
<p><strong>Use case</strong>: Trials with one continuous and one binary
outcome</p>
<p><strong>Statistical model</strong>: Normal distribution for
continuous endpoint, Bernoulli for binary endpoint, with biserial
correlation</p>
<p><strong>Key functions</strong>:</p>
<ul>
<li>
<code><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary()</a></code>: Sample size
calculation</li>
<li>
<code><a href="../reference/power2MixedContinuousBinary.html">power2MixedContinuousBinary()</a></code>: Power calculation</li>
<li>
<code><a href="../reference/twoCoprimary2MixedContinuousBinary.html">twoCoprimary2MixedContinuousBinary()</a></code>: Unified interface
for both</li>
</ul>
<p><strong>Reference</strong>: Sozu et al. (2012)</p>
<p><strong>Supported test methods for binary endpoint</strong>:</p>
<ul>
<li>AN: Asymptotic normal test without continuity correction</li>
<li>ANc: Asymptotic normal test with continuity correction</li>
<li>AS: Arcsine transformation without continuity correction</li>
<li>ASc: Arcsine transformation with continuity correction</li>
<li>Fisher: Fisher’s exact test (simulation-based)</li>
</ul>
<p><strong>Correlation structure</strong>: Uses biserial correlation
between observed continuous variable and latent continuous variable
underlying the binary outcome</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Continuous + Binary endpoints</span></span>
<span><span class="fu"><a href="../reference/ss2MixedContinuousBinary.html">ss2MixedContinuousBinary</a></span><span class="op">(</span></span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,           <span class="co"># Effect size for continuous endpoint</span></span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,                <span class="co"># Standard deviation</span></span>
<span>  p1 <span class="op">=</span> <span class="fl">0.7</span>,              <span class="co"># Success probability in treatment group</span></span>
<span>  p2 <span class="op">=</span> <span class="fl">0.4</span>,              <span class="co"># Success probability in control group</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,             <span class="co"># Biserial correlation</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  Test <span class="op">=</span> <span class="st">"AN"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for mixed continuous and binary co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 68</span></span>
<span><span class="co">#&gt;              n2 = 68</span></span>
<span><span class="co">#&gt;               N = 136</span></span>
<span><span class="co">#&gt;           delta = 0.5</span></span>
<span><span class="co">#&gt;              sd = 1</span></span>
<span><span class="co">#&gt;               p = 0.7, 0.4</span></span>
<span><span class="co">#&gt;             rho = 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span>
<span><span class="co">#&gt;            Test = AN</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mixed-count-and-continuous-endpoints">5. Mixed Count and Continuous Endpoints<a class="anchor" aria-label="anchor" href="#mixed-count-and-continuous-endpoints"></a>
</h3>
<p><strong>Use case</strong>: Trials with overdispersed count data
(e.g., exacerbations) and continuous outcomes (e.g., lung function)</p>
<p><strong>Statistical model</strong>: Negative binomial distribution
for count endpoint, normal distribution for continuous endpoint</p>
<p><strong>Key functions</strong>:</p>
<ul>
<li>
<code><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous()</a></code>: Sample size calculation</li>
<li>
<code><a href="../reference/power2MixedCountContinuous.html">power2MixedCountContinuous()</a></code>: Power calculation</li>
<li>
<code><a href="../reference/twoCoprimary2MixedCountContinuous.html">twoCoprimary2MixedCountContinuous()</a></code>: Unified interface
for both</li>
<li>
<code><a href="../reference/corrbound2MixedCountContinuous.html">corrbound2MixedCountContinuous()</a></code>: Calculate valid
correlation bounds</li>
</ul>
<p><strong>Reference</strong>: Homma and Yoshida (2024)</p>
<p><strong>Special considerations</strong>:</p>
<ul>
<li>The negative binomial distribution accommodates overdispersion
(variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&gt;</mo><annotation encoding="application/x-tex">&gt;</annotation></semantics></math>
mean) common in count data</li>
<li>
<strong>Treatment effects must be in the negative direction for both
endpoints</strong>: Lower event rate (count endpoint) and lower/better
continuous values indicate treatment benefit. For example, reduction in
exacerbation rate (<code>r1 &lt; r2</code>) and improvement in lung
function (e.g., <code>mu1 &lt; mu2</code> when lower is better, or
larger negative change from baseline)</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Count (exacerbations) + Continuous (FEV1)</span></span>
<span><span class="fu"><a href="../reference/ss2MixedCountContinuous.html">ss2MixedCountContinuous</a></span><span class="op">(</span></span>
<span>  r1 <span class="op">=</span> <span class="fl">1.0</span>, r2 <span class="op">=</span> <span class="fl">1.25</span>,   <span class="co"># Count rates (events per unit time)</span></span>
<span>  nu <span class="op">=</span> <span class="fl">0.8</span>,              <span class="co"># Dispersion parameter</span></span>
<span>  t <span class="op">=</span> <span class="fl">1</span>,                 <span class="co"># Follow-up time</span></span>
<span>  mu1 <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, mu2 <span class="op">=</span> <span class="fl">0</span>,    <span class="co"># Continuous means</span></span>
<span>  sd <span class="op">=</span> <span class="fl">250</span>,              <span class="co"># Standard deviation</span></span>
<span>  rho1 <span class="op">=</span> <span class="fl">0.5</span>, rho2 <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># Correlations</span></span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size calculation for mixed count and continuous co-primary endpoints</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              n1 = 705</span></span>
<span><span class="co">#&gt;              n2 = 705</span></span>
<span><span class="co">#&gt;               N = 1410</span></span>
<span><span class="co">#&gt;              sd = 250</span></span>
<span><span class="co">#&gt;            rate = 1, 1.25</span></span>
<span><span class="co">#&gt;              nu = 0.8</span></span>
<span><span class="co">#&gt;               t = 1</span></span>
<span><span class="co">#&gt;              mu = -50, 0</span></span>
<span><span class="co">#&gt;             rho = 0.5, 0.5</span></span>
<span><span class="co">#&gt;      allocation = 1</span></span>
<span><span class="co">#&gt;           alpha = 0.025</span></span>
<span><span class="co">#&gt;            beta = 0.2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="impact-of-correlation-1">Impact of Correlation<a class="anchor" aria-label="anchor" href="#impact-of-correlation-1"></a>
</h2>
<p>A key advantage of accounting for correlation between co-primary
endpoints is the potential for <strong>sample size
reduction</strong>.</p>
<p>The table below illustrates this for two continuous endpoints:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size at different correlation levels</span></span>
<span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">correlations</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ss2Continuous.html">ss2Continuous</a></span><span class="op">(</span></span>
<span>    delta1 <span class="op">=</span> <span class="fl">0.5</span>, delta2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    sd1 <span class="op">=</span> <span class="fl">1</span>, sd2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho</span>, r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    known_var <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">N</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Correlation <span class="op">=</span> <span class="va">correlations</span>,</span>
<span>  Total_N <span class="op">=</span> <span class="va">results</span>,</span>
<span>  Reduction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">results</span><span class="op">/</span><span class="va">results</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Correlation Total_N Reduction</span></span>
<span><span class="co">#&gt; 1         0.0     166        0%</span></span>
<span><span class="co">#&gt; 2         0.3     162      2.4%</span></span>
<span><span class="co">#&gt; 3         0.5     158      4.8%</span></span>
<span><span class="co">#&gt; 4         0.8     148     10.8%</span></span></code></pre></div>
<p>As correlation increases, the required sample size decreases. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>,
approximately 11% reduction in sample size can be achieved compared to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho = 0</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="why-does-correlation-matter">Why Does Correlation Matter?<a class="anchor" aria-label="anchor" href="#why-does-correlation-matter"></a>
</h3>
<p>The correlation between endpoints affects the joint distribution of
test statistics. When endpoints are positively correlated:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Test statistics tend to move together</strong>: If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Z_{1}</annotation></semantics></math>
is large,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Z_{2}</annotation></semantics></math>
is also likely to be large</li>
<li>
<strong>Higher probability of rejecting both nulls</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><mi>c</mi><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(Z_{1} &gt; c, Z_{2} &gt; c)</annotation></semantics></math>
increases with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
</li>
<li>
<strong>Sample size reduction</strong>: Fewer subjects needed to
achieve target power</li>
</ol>
<p>Mathematically, for bivariate normal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_{1}, Z_{2})</annotation></semantics></math>
with correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><mi>c</mi><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><mi>c</mi><mo>∣</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>&gt;</mo><mi>c</mi><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>&gt;</mo><mi>c</mi><mo>∣</mo><mi>ρ</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(Z_{1} &gt; c, Z_{2} &gt; c \mid \rho) &gt; \Pr(Z_{1} &gt; c, Z_{2} &gt; c \mid \rho = 0)</annotation></semantics></math></p>
<p>when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho &gt; 0</annotation></semantics></math>
and both endpoints have positive treatment effects.</p>
</div>
</div>
<div class="section level2">
<h2 id="choosing-the-right-method">Choosing the Right Method<a class="anchor" aria-label="anchor" href="#choosing-the-right-method"></a>
</h2>
<table style="width:100%;" class="table">
<colgroup>
<col width="28%">
<col width="23%">
<col width="14%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Endpoint Types</th>
<th>Sample Size</th>
<th>Method</th>
<th>Key Considerations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Both continuous</td>
<td>Any</td>
<td>Asymptotic</td>
<td>Simple, well-established</td>
</tr>
<tr class="even">
<td>Both binary</td>
<td>Large
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &gt; 200</annotation></semantics></math>)</td>
<td>Asymptotic</td>
<td>Fast computation, probabilities moderate</td>
</tr>
<tr class="odd">
<td>Both binary</td>
<td>Small/Medium</td>
<td>Exact</td>
<td>Better Type I error control, exact inference</td>
</tr>
<tr class="even">
<td>1 Continuous + 1 Binary</td>
<td>Any</td>
<td>Asymptotic</td>
<td>Handles mixed types, biserial correlation</td>
</tr>
<tr class="odd">
<td>1 Count + 1 Continuous</td>
<td>Any</td>
<td>Asymptotic</td>
<td>Accounts for overdispersion</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="decision-guidelines">Decision Guidelines<a class="anchor" aria-label="anchor" href="#decision-guidelines"></a>
</h3>
<p><strong>For binary endpoints</strong>:</p>
<ul>
<li>Use <strong>asymptotic methods</strong> when:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &gt; 200</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.1</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">0.1 &lt; p &lt; 0.9</annotation></semantics></math>,
computational efficiency important</li>
<li>Use <strong>exact methods</strong> when:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&lt;</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N &lt; 200</annotation></semantics></math>,
extreme probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">p &gt; 0.9</annotation></semantics></math>),
regulatory requirements for exact tests</li>
</ul>
<p><strong>For mixed endpoint types</strong>:</p>
<ul>
<li>Ensure correlation structure is appropriate (e.g., biserial for
continuous-binary)</li>
<li>Consider clinical plausibility of correlation magnitude</li>
<li>Use conservative estimates if correlation is uncertain</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="sample-size-calculation-approach">Sample Size Calculation Approach<a class="anchor" aria-label="anchor" href="#sample-size-calculation-approach"></a>
</h2>
<p>All methods in this package follow a similar computational
approach:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Specify design parameters</strong>: Effect sizes,
probabilities, standard deviations, etc.</li>
<li>
<strong>Specify correlation</strong>: Between endpoints</li>
<li>
<strong>Specify error rates</strong>: Type I error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
(typically 0.025 for one-sided) and Type II error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
(typically 0.2 for 80% power)</li>
<li>
<strong>Calculate sample size</strong>: Using iterative
algorithms</li>
<li>
<strong>Verify power</strong>: Confirm that calculated sample size
achieves target power</li>
</ol>
</div>
<div class="section level2">
<h2 id="detailed-vignettes">Detailed Vignettes<a class="anchor" aria-label="anchor" href="#detailed-vignettes"></a>
</h2>
<p>For detailed methodology, examples, and validation against published
results, please see:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../articles/two-continuous-endpoints.html">vignette("two-continuous-endpoints")</a></code>: Two continuous
endpoints</li>
<li>
<code><a href="../articles/two-binary-endpoints-approx.html">vignette("two-binary-endpoints-approx")</a></code>: Two binary
endpoints (asymptotic)</li>
<li>
<code><a href="../articles/two-binary-endpoints-exact.html">vignette("two-binary-endpoints-exact")</a></code>: Two binary
endpoints (exact)</li>
<li>
<code><a href="../articles/mixed-continuous-binary.html">vignette("mixed-continuous-binary")</a></code>: Mixed continuous
and binary</li>
<li>
<code><a href="../articles/mixed-count-continuous.html">vignette("mixed-count-continuous")</a></code>: Mixed count and
continuous</li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Homma, G., &amp; Yoshida, T. (2024). Sample size calculation in
clinical trials with two co-primary endpoints including overdispersed
count and continuous outcomes. <em>Pharmaceutical Statistics</em>,
23(1), 46-59.</p>
<p>Homma, G., &amp; Yoshida, T. (2025). Exact power and sample size in
clinical trials with two co-primary binary endpoints. <em>Statistical
Methods in Medical Research</em>, 34(1), 1-19.</p>
<p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2010). Sample size
determination in clinical trials with multiple co-primary binary
endpoints. <em>Statistics in Medicine</em>, 29(21), 2169-2179.</p>
<p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2011). Sample size
determination in superiority clinical trials with multiple co-primary
correlated endpoints. <em>Journal of Biopharmaceutical Statistics</em>,
21(4), 650-668.</p>
<p>Sozu, T., Sugimoto, T., &amp; Hamasaki, T. (2012). Sample size
determination in clinical trials with multiple co-primary endpoints
including mixed continuous and binary variables. <em>Biometrical
Journal</em>, 54(5), 716-729.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gosukehommaEX" class="external-link">Gosuke Homma</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  
</body>
</html>
